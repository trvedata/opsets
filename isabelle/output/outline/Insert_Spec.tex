%
\begin{isabellebody}%
\setisabellecontext{Insert{\isacharunderscore}Spec}%
%
\isamarkupsection{Specifying list insertion%
}
\isamarkuptrue%
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Insert{\isacharunderscore}Spec\isanewline
\ \ \isakeyword{imports}\ OpSet\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
In this section we consider only list insertion. We model an insertion
operation as a pair (ID, ref), where ref is either ``None'' (signifying an
insertion at the head of the list) or ``Some r'' (an insertion immediately
after a reference element with ID ``r''). If the reference element does not
exist, the operation does nothing.

We provide two different definitions of the interpretation function for list
insertion: insert\_spec and insert\_alt. The insert\_alt definition matches
the paper, while insert\_spec uses the Isabelle/HOL list datatype, making it
more suitable for formal reasoning. In a later subsection we prove that the
two definitions are in fact equivalent.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ insert{\isacharunderscore}spec\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharprime}oid\ list\ {\isasymRightarrow}\ {\isacharparenleft}{\isacharprime}oid\ {\isasymtimes}\ {\isacharprime}oid\ option{\isacharparenright}\ {\isasymRightarrow}\ {\isacharprime}oid\ list{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ xs\ \ \ \ \ {\isacharparenleft}oid{\isacharcomma}\ None{\isacharparenright}\ \ \ \ \ {\isacharequal}\ oid{\isacharhash}xs{\isachardoublequoteclose}\ {\isacharbar}\isanewline
\ \ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharbrackleft}{\isacharbrackright}\ \ \ \ \ {\isacharparenleft}oid{\isacharcomma}\ {\isacharunderscore}{\isacharparenright}\ \ \ \ \ \ \ \ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\ {\isacharbar}\isanewline
\ \ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}x{\isacharhash}xs{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ {\isacharparenleft}if\ x\ {\isacharequal}\ ref\ then\ x\ {\isacharhash}\ oid\ {\isacharhash}\ xs\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ else\ x\ {\isacharhash}\ {\isacharparenleft}insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ insert{\isacharunderscore}alt\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}{\isacharprime}oid\ {\isasymtimes}\ {\isacharprime}oid\ option{\isacharparenright}\ set\ {\isasymRightarrow}\ {\isacharparenleft}{\isacharprime}oid\ {\isasymtimes}\ {\isacharprime}oid{\isacharparenright}\ {\isasymRightarrow}\ {\isacharparenleft}{\isacharprime}oid\ {\isasymtimes}\ {\isacharprime}oid\ option{\isacharparenright}\ set{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}insert{\isacharunderscore}alt\ list{\isacharunderscore}rel\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}\isanewline
\ \ \ \ \ \ if\ {\isasymexists}n{\isachardot}\ {\isacharparenleft}ref{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ list{\isacharunderscore}rel\isanewline
\ \ \ \ \ \ then\ {\isacharbraceleft}{\isacharparenleft}p{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ list{\isacharunderscore}rel{\isachardot}\ p\ {\isasymnoteq}\ ref{\isacharbraceright}\ {\isasymunion}\ {\isacharbraceleft}{\isacharparenleft}ref{\isacharcomma}\ Some\ oid{\isacharparenright}{\isacharbraceright}\ {\isasymunion}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\isacharparenleft}i{\isacharcomma}\ n{\isacharparenright}{\isachardot}\ i\ {\isacharequal}\ oid\ {\isasymand}\ {\isacharparenleft}ref{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ list{\isacharunderscore}rel{\isacharbraceright}\isanewline
\ \ \ \ \ \ else\ list{\isacharunderscore}rel{\isacharparenright}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
The make\_insert function generates a new operation for insertion into
a given index in a given list.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ make{\isacharunderscore}insert\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharprime}oid\ list\ {\isasymRightarrow}\ {\isacharprime}oid\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ {\isacharparenleft}{\isacharprime}oid\ {\isasymtimes}\ {\isacharprime}oid\ option{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}make{\isacharunderscore}insert\ xs\ oid\ {\isadigit{0}}\ \ \ \ \ \ \ {\isacharequal}\ {\isacharparenleft}oid{\isacharcomma}\ None{\isacharparenright}{\isachardoublequoteclose}\ {\isacharbar}\isanewline
\ \ {\isachardoublequoteopen}make{\isacharunderscore}insert\ {\isacharbrackleft}{\isacharbrackright}\ oid\ m\ \ \ \ \ \ \ {\isacharequal}\ {\isacharparenleft}oid{\isacharcomma}\ None{\isacharparenright}{\isachardoublequoteclose}\ {\isacharbar}\isanewline
\ \ {\isachardoublequoteopen}make{\isacharunderscore}insert\ xs\ oid\ {\isacharparenleft}Suc\ m{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ {\isacharparenleft}xs\ {\isacharbang}\ min\ {\isacharparenleft}length\ xs\ {\isacharminus}\ {\isadigit{1}}{\isacharparenright}\ m{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
interp\_list is the sequential interpretation of a set of insertion
operations. It starts with an empty list as initial state, and then applies
the operations from left to right.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ interp{\isacharunderscore}list\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}{\isacharprime}oid\ {\isasymtimes}\ {\isacharprime}oid\ option{\isacharparenright}\ list\ {\isasymRightarrow}\ {\isacharprime}oid\ list{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}interp{\isacharunderscore}list\ ops\ {\isasymequiv}\ foldl\ insert{\isacharunderscore}spec\ {\isacharbrackleft}{\isacharbrackright}\ ops{\isachardoublequoteclose}%
\isamarkupsubsection{The insert\_ops predicate%
}
\isamarkuptrue%
%
\begin{isamarkuptext}%
We now specialise the definitions from the abstract OpSet section for list
insertion. insert\_opset is an opset consisting only of insertion operations,
and insert\_ops is the specialisation of the spec\_ops predicate for
insertion operations. We prove several useful lemmas about insert\_ops.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{locale}\isamarkupfalse%
\ insert{\isacharunderscore}opset\ {\isacharequal}\ opset\ opset\ set{\isacharunderscore}option\isanewline
\ \ \isakeyword{for}\ opset\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}{\isacharprime}oid{\isacharcolon}{\isacharcolon}{\isacharbraceleft}linorder{\isacharbraceright}\ {\isasymtimes}\ {\isacharprime}oid\ option{\isacharparenright}\ set{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ insert{\isacharunderscore}ops\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}{\isacharprime}oid{\isacharcolon}{\isacharcolon}{\isacharbraceleft}linorder{\isacharbraceright}\ {\isasymtimes}\ {\isacharprime}oid\ option{\isacharparenright}\ list\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ list\ {\isasymequiv}\ spec{\isacharunderscore}ops\ set{\isacharunderscore}option\ list{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ insert{\isacharunderscore}ops{\isacharunderscore}NilI\ {\isacharbrackleft}intro{\isacharbang}{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ insert{\isacharunderscore}ops{\isacharunderscore}def\ spec{\isacharunderscore}ops{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ insert{\isacharunderscore}ops{\isacharunderscore}rem{\isacharunderscore}last\ {\isacharbrackleft}dest{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ {\isacharparenleft}xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ xs{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ insert{\isacharunderscore}ops{\isacharunderscore}def\ spec{\isacharunderscore}ops{\isacharunderscore}rem{\isacharunderscore}last\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ insert{\isacharunderscore}ops{\isacharunderscore}appendD{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ {\isacharparenleft}xs\ {\isacharat}\ ys{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ xs{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induction\ ys\ rule{\isacharcolon}\ List{\isachardot}rev{\isacharunderscore}induct{\isacharcomma}\isanewline
\ \ auto{\isacharcomma}\ metis\ insert{\isacharunderscore}ops{\isacharunderscore}rem{\isacharunderscore}last\ append{\isacharunderscore}assoc{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ insert{\isacharunderscore}ops{\isacharunderscore}rem{\isacharunderscore}prefix{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ {\isacharparenleft}pre\ {\isacharat}\ suf{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ suf{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induction\ pre{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ {\isacharparenleft}{\isacharbrackleft}{\isacharbrackright}\ {\isacharat}\ suf{\isacharparenright}\ {\isasymLongrightarrow}\ insert{\isacharunderscore}ops\ suf{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ pre{\isacharparenright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sorted\ {\isacharparenleft}map\ fst\ suf{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ insert{\isacharunderscore}ops{\isacharunderscore}def\ sorted{\isacharunderscore}append\ spec{\isacharunderscore}ops{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}map\ fst\ suf{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ insert{\isacharunderscore}ops{\isacharunderscore}def\ spec{\isacharunderscore}ops{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ {\isacharparenleft}{\isacharparenleft}a\ {\isacharhash}\ pre{\isacharparenright}\ {\isacharat}\ suf{\isacharparenright}\ {\isasymLongrightarrow}\ insert{\isacharunderscore}ops\ suf{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ insert{\isacharunderscore}ops{\isacharunderscore}def\ spec{\isacharunderscore}ops{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ insert{\isacharunderscore}ops{\isacharunderscore}remove{\isadigit{1}}{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ xs{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ {\isacharparenleft}remove{\isadigit{1}}\ x\ xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ insert{\isacharunderscore}ops{\isacharunderscore}def\ spec{\isacharunderscore}ops{\isacharunderscore}remove{\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ last{\isacharunderscore}op{\isacharunderscore}greatest{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ {\isacharparenleft}op{\isacharunderscore}list\ {\isacharat}\ {\isacharbrackleft}{\isacharparenleft}oid{\isacharcomma}\ oper{\isacharparenright}{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}map\ fst\ op{\isacharunderscore}list{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}x\ {\isacharless}\ oid{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ spec{\isacharunderscore}ops{\isacharunderscore}id{\isacharunderscore}inc\ insert{\isacharunderscore}ops{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ metis%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ insert{\isacharunderscore}ops{\isacharunderscore}ref{\isacharunderscore}older{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ {\isacharparenleft}pre\ {\isacharat}\ {\isacharbrackleft}{\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}{\isacharbrackright}\ {\isacharat}\ suf{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}ref\ {\isacharless}\ oid{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ insert{\isacharunderscore}ops{\isacharunderscore}def\ spec{\isacharunderscore}ops{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ insert{\isacharunderscore}ops{\isacharunderscore}memb{\isacharunderscore}ref{\isacharunderscore}older{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ op{\isacharunderscore}list{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}\ {\isasymin}\ set\ op{\isacharunderscore}list{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}ref\ {\isacharless}\ oid{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ insert{\isacharunderscore}ops{\isacharunderscore}ref{\isacharunderscore}older\ split{\isacharunderscore}list{\isacharunderscore}first\ \isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isamarkupsubsection{Properties of the insert\_spec function%
}
\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ insert{\isacharunderscore}spec{\isacharunderscore}none\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}set\ {\isacharparenleft}insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}oid{\isacharcomma}\ None{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ set\ xs\ {\isasymunion}\ {\isacharbraceleft}oid{\isacharbraceright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induction\ xs{\isacharcomma}\ auto\ simp\ add{\isacharcolon}\ insert{\isacharunderscore}commute\ sup{\isacharunderscore}commute{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ insert{\isacharunderscore}spec{\isacharunderscore}set\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}ref\ {\isasymin}\ set\ xs{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}set\ {\isacharparenleft}insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ set\ xs\ {\isasymunion}\ {\isacharbraceleft}oid{\isacharbraceright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induction\ xs{\isacharparenright}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}ref\ {\isasymin}\ set\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ set\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymunion}\ {\isacharbraceleft}oid{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ a\ xs\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}ref\ {\isasymin}\ set\ xs\ {\isasymLongrightarrow}\ set\ {\isacharparenleft}insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ set\ xs\ {\isasymunion}\ {\isacharbraceleft}oid{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}ref\ {\isasymin}\ set\ {\isacharparenleft}a{\isacharhash}xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharparenleft}a{\isacharhash}xs{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ set\ {\isacharparenleft}a{\isacharhash}xs{\isacharparenright}\ {\isasymunion}\ {\isacharbraceleft}oid{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}a\ {\isacharequal}\ ref{\isachardoublequoteclose}{\isacharcomma}\ auto\ simp\ add{\isacharcolon}\ insert{\isacharunderscore}commute\ sup{\isacharunderscore}commute{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ insert{\isacharunderscore}spec{\isacharunderscore}nonex\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}ref\ {\isasymnotin}\ set\ xs{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}\ {\isacharequal}\ xs{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induction\ xs{\isacharparenright}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ a\ xs\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}ref\ {\isasymnotin}\ set\ xs\ {\isasymLongrightarrow}\ insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}\ {\isacharequal}\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}ref\ {\isasymnotin}\ set\ {\isacharparenleft}a{\isacharhash}xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}a{\isacharhash}xs{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}\ {\isacharequal}\ a{\isacharhash}xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}a\ {\isacharequal}\ ref{\isachardoublequoteclose}{\isacharcomma}\ auto\ simp\ add{\isacharcolon}\ insert{\isacharunderscore}commute\ sup{\isacharunderscore}commute{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}greater{\isacharunderscore}non{\isacharunderscore}memb{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ oid\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharprime}oid{\isacharcolon}{\isacharcolon}{\isacharbraceleft}linorder{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}\ x\ {\isasymin}\ set\ xs\ {\isasymLongrightarrow}\ x\ {\isacharless}\ oid{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}oid\ {\isasymin}\ set\ xs{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}False{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \ \isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inserted{\isacharunderscore}item{\isacharunderscore}ident{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}a\ {\isasymin}\ set\ {\isacharparenleft}insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}e{\isacharcomma}\ i{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}a\ {\isasymnotin}\ set\ xs{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}a\ {\isacharequal}\ e{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induction\ xs{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isacharequal}\ e{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ i{\isacharcomma}\ auto{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ x\ xs{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isacharequal}\ e{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}cases\ i{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ None\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isacharequal}\ e{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Some\ ref{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isacharequal}\ e{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ Cons\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}x\ {\isacharequal}\ ref{\isachardoublequoteclose}{\isacharcomma}\ auto{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ insert{\isacharunderscore}spec{\isacharunderscore}distinct\ {\isacharbrackleft}intro{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ oid\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharprime}oid{\isacharcolon}{\isacharcolon}{\isacharbraceleft}linorder{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}distinct\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}\ x\ {\isasymin}\ set\ xs\ {\isasymLongrightarrow}\ x\ {\isacharless}\ oid{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}ref\ {\isacharequal}\ Some\ r\ {\isasymlongrightarrow}\ r\ {\isacharless}\ oid{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induction\ xs{\isacharparenright}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}cases\ ref{\isacharcomma}\ auto{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ a\ xs\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ IH{\isacharcolon}\ {\isachardoublequoteopen}distinct\ xs\ {\isasymLongrightarrow}\ {\isacharparenleft}{\isasymAnd}x{\isachardot}\ x\ {\isasymin}\ set\ xs\ {\isasymLongrightarrow}\ x\ {\isacharless}\ oid{\isacharparenright}\ {\isasymLongrightarrow}\ distinct\ {\isacharparenleft}insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ D{\isacharcolon}\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}a{\isacharhash}xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ L{\isacharcolon}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}\ x\ {\isasymin}\ set\ {\isacharparenleft}a{\isacharhash}xs{\isacharparenright}\ {\isasymLongrightarrow}\ x\ {\isacharless}\ oid{\isachardoublequoteclose}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharparenleft}a{\isacharhash}xs{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}ref{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}ref\ {\isacharequal}\ None{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharparenleft}a{\isacharhash}xs{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ D\ L\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ id\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ S{\isacharcolon}\ {\isachardoublequoteopen}ref\ {\isacharequal}\ Some\ id{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ EQ{\isacharcolon}\ {\isachardoublequoteopen}a\ {\isacharequal}\ id{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}id\ {\isasymnoteq}\ oid{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ D\ L\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}id\ {\isasymnotin}\ set\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ D\ EQ\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}oid\ {\isasymnotin}\ set\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ L\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}id\ {\isasymnoteq}\ oid\ {\isasymand}\ id\ {\isasymnotin}\ set\ xs\ {\isasymand}\ oid\ {\isasymnotin}\ set\ xs\ {\isasymand}\ distinct\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ D\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{note}\isamarkupfalse%
\ T\ {\isacharequal}\ this\isanewline
\ \ \ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ NEQ{\isacharcolon}\ {\isachardoublequoteopen}a\ {\isasymnoteq}\ id{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isadigit{0}}{\isacharcolon}\ {\isachardoublequoteopen}a\ {\isasymnotin}\ set\ {\isacharparenleft}insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}oid{\isacharcomma}\ Some\ id{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ D\ L\ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}metis\ distinct{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ insert{\isacharunderscore}spec{\isachardot}simps{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ insert{\isacharunderscore}spec{\isacharunderscore}none\ insert{\isacharunderscore}spec{\isacharunderscore}nonex\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ insert{\isacharunderscore}spec{\isacharunderscore}set\ insert{\isacharunderscore}iff\ list{\isachardot}set{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ not{\isacharunderscore}less{\isacharunderscore}iff{\isacharunderscore}gr{\isacharunderscore}or{\isacharunderscore}eq{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}distinct\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ D\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}\ x\ {\isasymin}\ set\ xs\ {\isasymLongrightarrow}\ x\ {\isacharless}\ oid{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ L\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}oid{\isacharcomma}\ Some\ id{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ S\ IH{\isacharbrackleft}OF\ {\isadigit{1}}{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isasymnotin}\ set\ {\isacharparenleft}insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}oid{\isacharcomma}\ Some\ id{\isacharparenright}{\isacharparenright}\ {\isasymand}\ distinct\ {\isacharparenleft}insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}oid{\isacharcomma}\ Some\ id{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isadigit{0}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ this\ S\ T\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ clarsimp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ insert{\isacharunderscore}after{\isacharunderscore}ref{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}xs\ {\isacharat}\ ref\ {\isacharhash}\ ys{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}xs\ {\isacharat}\ ref\ {\isacharhash}\ ys{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ ref\ {\isacharhash}\ oid\ {\isacharhash}\ ys{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induction\ xs{\isacharcomma}\ auto{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ insert{\isacharunderscore}somewhere{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}ref\ {\isacharequal}\ None\ {\isasymor}\ {\isacharparenleft}ref\ {\isacharequal}\ Some\ r\ {\isasymand}\ r\ {\isasymin}\ set\ list{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymexists}xs\ ys{\isachardot}\ list\ {\isacharequal}\ xs\ {\isacharat}\ ys\ {\isasymand}\ insert{\isacharunderscore}spec\ list\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ oid\ {\isacharhash}\ ys{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induction\ list{\isacharparenright}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}ref\ {\isacharequal}\ None\ {\isasymor}\ ref\ {\isacharequal}\ Some\ r\ {\isasymand}\ r\ {\isasymin}\ set\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}xs\ ys{\isachardot}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ xs\ {\isacharat}\ ys\ {\isasymand}\ insert{\isacharunderscore}spec\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ oid\ {\isacharhash}\ ys{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}ref\ {\isacharequal}\ None{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}xs\ ys{\isachardot}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ xs\ {\isacharat}\ ys\ {\isasymand}\ insert{\isacharunderscore}spec\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ oid\ {\isacharhash}\ ys{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}ref\ {\isacharequal}\ Some\ r\ {\isasymand}\ r\ {\isasymin}\ set\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}xs\ ys{\isachardot}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ xs\ {\isacharat}\ ys\ {\isasymand}\ insert{\isacharunderscore}spec\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ oid\ {\isacharhash}\ ys{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ a\ list\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}ref\ {\isacharequal}\ None\ {\isasymor}\ ref\ {\isacharequal}\ Some\ r\ {\isasymand}\ r\ {\isasymin}\ set\ {\isacharparenleft}a{\isacharhash}list{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ IH{\isacharcolon}\ {\isachardoublequoteopen}ref\ {\isacharequal}\ None\ {\isasymor}\ ref\ {\isacharequal}\ Some\ r\ {\isasymand}\ r\ {\isasymin}\ set\ list\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ {\isasymexists}xs\ ys{\isachardot}\ list\ {\isacharequal}\ xs\ {\isacharat}\ ys\ {\isasymand}\ insert{\isacharunderscore}spec\ list\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ oid\ {\isacharhash}\ ys{\isachardoublequoteclose}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}xs\ ys{\isachardot}\ a\ {\isacharhash}\ list\ {\isacharequal}\ xs\ {\isacharat}\ ys\ {\isasymand}\ insert{\isacharunderscore}spec\ {\isacharparenleft}a\ {\isacharhash}\ list{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ oid\ {\isacharhash}\ ys{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}rule\ disjE{\isacharbrackleft}OF\ {\isadigit{1}}{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}ref\ {\isacharequal}\ None{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}xs\ ys{\isachardot}\ a\ {\isacharhash}\ list\ {\isacharequal}\ xs\ {\isacharat}\ ys\ {\isasymand}\ insert{\isacharunderscore}spec\ {\isacharparenleft}a\ {\isacharhash}\ list{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ oid\ {\isacharhash}\ ys{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}ref\ {\isacharequal}\ Some\ r\ {\isasymand}\ r\ {\isasymin}\ set\ {\isacharparenleft}a\ {\isacharhash}\ list{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isadigit{2}}{\isacharcolon}\ {\isachardoublequoteopen}r\ {\isacharequal}\ a\ {\isasymor}\ r\ {\isasymin}\ set\ list{\isachardoublequoteclose}\ \isakeyword{and}\ {\isadigit{3}}{\isacharcolon}\ {\isachardoublequoteopen}ref\ {\isacharequal}\ Some\ r{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}xs\ ys{\isachardot}\ a\ {\isacharhash}\ list\ {\isacharequal}\ xs\ {\isacharat}\ ys\ {\isasymand}\ insert{\isacharunderscore}spec\ {\isacharparenleft}a\ {\isacharhash}\ list{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ oid\ {\isacharhash}\ ys{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}rule\ disjE{\isacharbrackleft}OF\ {\isadigit{2}}{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}r\ {\isacharequal}\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}xs\ ys{\isachardot}\ a\ {\isacharhash}\ list\ {\isacharequal}\ xs\ {\isacharat}\ ys\ {\isasymand}\ insert{\isacharunderscore}spec\ {\isacharparenleft}a\ {\isacharhash}\ list{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ oid\ {\isacharhash}\ ys{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}metis\ append{\isacharunderscore}Cons\ append{\isacharunderscore}Nil\ insert{\isacharunderscore}spec{\isachardot}simps{\isacharparenleft}{\isadigit{3}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}r\ {\isasymin}\ set\ list{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ this\ \isacommand{obtain}\isamarkupfalse%
\ xs\ ys\isanewline
\ \ \ \ \ \ \ \ \isakeyword{where}\ {\isachardoublequoteopen}list\ {\isacharequal}\ xs\ {\isacharat}\ ys\ {\isasymand}\ insert{\isacharunderscore}spec\ list\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ oid\ {\isacharhash}\ ys{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ IH\ {\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}xs\ ys{\isachardot}\ a\ {\isacharhash}\ list\ {\isacharequal}\ xs\ {\isacharat}\ ys\ {\isasymand}\ insert{\isacharunderscore}spec\ {\isacharparenleft}a\ {\isacharhash}\ list{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ oid\ {\isacharhash}\ ys{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ clarsimp\ {\isacharparenleft}metis\ append{\isacharunderscore}Cons\ append{\isacharunderscore}Nil{\isacharparenright}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ insert{\isacharunderscore}first{\isacharunderscore}part{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}ref\ {\isacharequal}\ None\ {\isasymor}\ {\isacharparenleft}ref\ {\isacharequal}\ Some\ r\ {\isasymand}\ r\ {\isasymin}\ set\ xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}xs\ {\isacharat}\ ys{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isacharparenright}\ {\isacharat}\ ys{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induction\ ys\ rule{\isacharcolon}\ rev{\isacharunderscore}induct{\isacharparenright}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}ref\ {\isacharequal}\ None\ {\isasymor}\ ref\ {\isacharequal}\ Some\ r\ {\isasymand}\ r\ {\isasymin}\ set\ xs{\isachardoublequoteclose}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}xs\ {\isacharat}\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharat}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ xsa\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ IH{\isacharcolon}\ {\isachardoublequoteopen}ref\ {\isacharequal}\ None\ {\isasymor}\ ref\ {\isacharequal}\ Some\ r\ {\isasymand}\ r\ {\isasymin}\ set\ xs\ {\isasymLongrightarrow}\ insert{\isacharunderscore}spec\ {\isacharparenleft}xs\ {\isacharat}\ xsa{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharat}\ xsa{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}ref\ {\isacharequal}\ None\ {\isasymor}\ ref\ {\isacharequal}\ Some\ r\ {\isasymand}\ r\ {\isasymin}\ set\ xs{\isachardoublequoteclose}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}xs\ {\isacharat}\ xsa\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharat}\ xsa\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induction\ xs{\isacharparenright}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}ref\ {\isacharequal}\ None\ {\isasymor}\ ref\ {\isacharequal}\ Some\ r\ {\isasymand}\ r\ {\isasymin}\ set\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}{\isacharbrackleft}{\isacharbrackright}\ {\isacharat}\ xsa\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ insert{\isacharunderscore}spec\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharat}\ xsa\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ a\ xs\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}ref\ {\isacharequal}\ None\ {\isasymor}\ ref\ {\isacharequal}\ Some\ r\ {\isasymand}\ r\ {\isasymin}\ set\ {\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeyword{and}\ {\isadigit{2}}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}{\isacharparenleft}ref\ {\isacharequal}\ None\ {\isasymor}\ ref\ {\isacharequal}\ Some\ r\ {\isasymand}\ r\ {\isasymin}\ set\ xs\ {\isasymLongrightarrow}\ insert{\isacharunderscore}spec\ {\isacharparenleft}xs\ {\isacharat}\ xsa{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharat}\ xsa{\isacharparenright}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ ref\ {\isacharequal}\ None\ {\isasymor}\ ref\ {\isacharequal}\ Some\ r\ {\isasymand}\ r\ {\isasymin}\ set\ xs\ {\isasymLongrightarrow}\ insert{\isacharunderscore}spec\ {\isacharparenleft}xs\ {\isacharat}\ xsa\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharat}\ xsa\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeyword{and}\ {\isadigit{3}}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}ref\ {\isacharequal}\ None\ {\isasymor}\ ref\ {\isacharequal}\ Some\ r\ {\isasymand}\ r\ {\isasymin}\ set\ {\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isasymLongrightarrow}\ insert{\isacharunderscore}spec\ {\isacharparenleft}{\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharat}\ xsa{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ insert{\isacharunderscore}spec\ {\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharat}\ xsa{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}{\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharat}\ xsa\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ insert{\isacharunderscore}spec\ {\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharat}\ xsa\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}rule\ disjE{\isacharbrackleft}OF\ {\isadigit{1}}{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}ref\ {\isacharequal}\ None{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}{\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharat}\ xsa\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ insert{\isacharunderscore}spec\ {\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharat}\ xsa\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}ref\ {\isacharequal}\ Some\ r\ {\isasymand}\ r\ {\isasymin}\ set\ {\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}{\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharat}\ xsa\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ insert{\isacharunderscore}spec\ {\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharat}\ xsa\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isadigit{2}}\ {\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ insert{\isacharunderscore}second{\isacharunderscore}part{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}ref\ {\isacharequal}\ Some\ r{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}r\ {\isasymnotin}\ set\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}r\ {\isasymin}\ set\ ys{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}xs\ {\isacharat}\ ys{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ {\isacharparenleft}insert{\isacharunderscore}spec\ ys\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induction\ xs{\isacharparenright}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}ref\ {\isacharequal}\ Some\ r{\isachardoublequoteclose}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}{\isacharbrackleft}{\isacharbrackright}\ {\isacharat}\ ys{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharat}\ insert{\isacharunderscore}spec\ ys\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ a\ xs\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}ref\ {\isacharequal}\ Some\ r{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}r\ {\isasymnotin}\ set\ {\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}r\ {\isasymin}\ set\ ys{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}ref\ {\isacharequal}\ Some\ r\ {\isasymLongrightarrow}\ r\ {\isasymnotin}\ set\ xs\ {\isasymLongrightarrow}\ r\ {\isasymin}\ set\ ys\ {\isasymLongrightarrow}\ insert{\isacharunderscore}spec\ {\isacharparenleft}xs\ {\isacharat}\ ys{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ insert{\isacharunderscore}spec\ ys\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}{\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharat}\ ys{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharat}\ insert{\isacharunderscore}spec\ ys\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isamarkupsubsection{Properties of the interp\_list function%
}
\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ interp{\isacharunderscore}list{\isacharunderscore}empty\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ interp{\isacharunderscore}list{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ interp{\isacharunderscore}list{\isacharunderscore}tail{\isacharunderscore}unfold{\isacharcolon}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ {\isacharparenleft}xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}\ {\isacharequal}\ insert{\isacharunderscore}spec\ {\isacharparenleft}interp{\isacharunderscore}list\ xs{\isacharparenright}\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}clarsimp\ simp\ add{\isacharcolon}\ interp{\isacharunderscore}list{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ interp{\isacharunderscore}list{\isacharunderscore}subset\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}set\ {\isacharparenleft}interp{\isacharunderscore}list\ op{\isacharunderscore}list{\isacharparenright}\ {\isasymsubseteq}\ set\ {\isacharparenleft}map\ fst\ op{\isacharunderscore}list{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induction\ op{\isacharunderscore}list\ rule{\isacharcolon}\ List{\isachardot}rev{\isacharunderscore}induct{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ {\isacharparenleft}interp{\isacharunderscore}list\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}\ {\isasymsubseteq}\ set\ {\isacharparenleft}map\ fst\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ interp{\isacharunderscore}list{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}snoc\ x\ xs{\isacharparenright}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ IH{\isacharcolon}\ {\isachardoublequoteopen}set\ {\isacharparenleft}interp{\isacharunderscore}list\ xs{\isacharparenright}\ {\isasymsubseteq}\ set\ {\isacharparenleft}map\ fst\ xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ interp{\isacharunderscore}list{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ oid\ ref\ \isakeyword{where}\ x{\isacharunderscore}pair{\isacharcolon}\ {\isachardoublequoteopen}x\ {\isacharequal}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ spec{\isacharcolon}\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ {\isacharparenleft}xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}\ {\isacharequal}\ insert{\isacharunderscore}spec\ {\isacharparenleft}interp{\isacharunderscore}list\ xs{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ interp{\isacharunderscore}list{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ {\isacharparenleft}interp{\isacharunderscore}list\ {\isacharparenleft}xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}{\isacharparenright}\ {\isasymsubseteq}\ set\ {\isacharparenleft}map\ fst\ {\isacharparenleft}xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}cases\ ref{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ None\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ {\isacharparenleft}interp{\isacharunderscore}list\ {\isacharparenleft}xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}{\isacharparenright}\ {\isasymsubseteq}\ set\ {\isacharparenleft}map\ fst\ {\isacharparenleft}xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ IH\ spec\ x{\isacharunderscore}pair\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Some\ a{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ {\isacharparenleft}interp{\isacharunderscore}list\ {\isacharparenleft}xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}{\isacharparenright}\ {\isasymsubseteq}\ set\ {\isacharparenleft}map\ fst\ {\isacharparenleft}xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ IH\ spec\ x{\isacharunderscore}pair\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}a\ {\isasymin}\ set\ {\isacharparenleft}interp{\isacharunderscore}list\ xs{\isacharparenright}{\isachardoublequoteclose}{\isacharcomma}\ auto{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ interp{\isacharunderscore}list{\isacharunderscore}distinct{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ op{\isacharunderscore}list{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}interp{\isacharunderscore}list\ op{\isacharunderscore}list{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induction\ op{\isacharunderscore}list\ rule{\isacharcolon}\ rev{\isacharunderscore}induct{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}interp{\isacharunderscore}list\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ interp{\isacharunderscore}list{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}snoc\ x\ xs{\isacharparenright}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ IH{\isacharcolon}\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}interp{\isacharunderscore}list\ xs{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ oid\ ref\ \isakeyword{where}\ x{\isacharunderscore}pair{\isacharcolon}\ {\isachardoublequoteopen}x\ {\isacharequal}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}x\ {\isasymin}\ set\ {\isacharparenleft}map\ fst\ xs{\isacharparenright}{\isachardot}\ x\ {\isacharless}\ oid{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ last{\isacharunderscore}op{\isacharunderscore}greatest\ snoc{\isachardot}prems\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}x\ {\isasymin}\ set\ {\isacharparenleft}interp{\isacharunderscore}list\ xs{\isacharparenright}{\isachardot}\ x\ {\isacharless}\ oid{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ interp{\isacharunderscore}list{\isacharunderscore}subset\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharparenleft}interp{\isacharunderscore}list\ xs{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ IH\ insert{\isacharunderscore}spec{\isacharunderscore}distinct\ insert{\isacharunderscore}spec{\isacharunderscore}nonex\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}interp{\isacharunderscore}list\ {\isacharparenleft}xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ x{\isacharunderscore}pair\ interp{\isacharunderscore}list{\isacharunderscore}tail{\isacharunderscore}unfold{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isamarkupsubsection{Equivalence of the two definitions of insertion%
}
\isamarkuptrue%
%
\begin{isamarkuptext}%
At the beginning of this section we gave two different definitions of
interpretation functions for list insertion: insert\_spec and insert\_alt.
In this section we prove that the two are equivalent.

We first define how to derive the successor relation from an Isabelle list.
This relation contains (\emph{id}, None) if \emph{id} is the last element
of the list, and (\emph{id1}, \emph{id2}) if \emph{id1} is immediately
followed by \emph{id2} in the list.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ succ{\isacharunderscore}rel\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharprime}oid\ list\ {\isasymRightarrow}\ {\isacharparenleft}{\isacharprime}oid\ {\isasymtimes}\ {\isacharprime}oid\ option{\isacharparenright}\ set{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\ {\isacharbar}\isanewline
\ \ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharbrackleft}head{\isacharbrackright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharparenleft}head{\isacharcomma}\ None{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\ {\isacharbar}\isanewline
\ \ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}head{\isacharhash}x{\isacharhash}xs{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharparenleft}head{\isacharcomma}\ Some\ x{\isacharparenright}{\isacharbraceright}\ {\isasymunion}\ succ{\isacharunderscore}rel\ {\isacharparenleft}x{\isacharhash}xs{\isacharparenright}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
interp\_alt is the equivalent of interp\_list, but using insert\_alt
instead of insert\_spec. To match the paper, it uses a distinct head element
to refer to the beginning of the list.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ interp{\isacharunderscore}alt\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharprime}oid\ {\isasymRightarrow}\ {\isacharparenleft}{\isacharprime}oid\ {\isasymtimes}\ {\isacharprime}oid\ option{\isacharparenright}\ list\ {\isasymRightarrow}\ {\isacharparenleft}{\isacharprime}oid\ {\isasymtimes}\ {\isacharprime}oid\ option{\isacharparenright}\ set{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}interp{\isacharunderscore}alt\ head\ ops\ {\isasymequiv}\ foldl\ insert{\isacharunderscore}alt\ {\isacharbraceleft}{\isacharparenleft}head{\isacharcomma}\ None{\isacharparenright}{\isacharbraceright}\isanewline
\ \ \ \ \ {\isacharparenleft}map\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ case\ x\ of\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}oid{\isacharcomma}\ None{\isacharparenright}\ \ \ \ \ {\isasymRightarrow}\ {\isacharparenleft}oid{\isacharcomma}\ head{\isacharparenright}\ {\isacharbar}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}\ {\isasymRightarrow}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isacharparenright}\ \isanewline
\ \ \ \ \ \ ops{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ succ{\isacharunderscore}rel{\isacharunderscore}set{\isacharunderscore}fst{\isacharcolon}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}fst\ {\isacharbackquote}\ {\isacharparenleft}succ{\isacharunderscore}rel\ xs{\isacharparenright}\ {\isacharequal}\ set\ xs{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induction\ xs\ rule{\isacharcolon}\ succ{\isacharunderscore}rel{\isachardot}induct{\isacharcomma}\ auto{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ succ{\isacharunderscore}rel{\isacharunderscore}functional{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}a{\isacharcomma}\ b{\isadigit{1}}{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isacharparenleft}a{\isacharcomma}\ b{\isadigit{2}}{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}distinct\ xs{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}b{\isadigit{1}}\ {\isacharequal}\ b{\isadigit{2}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induction\ xs\ rule{\isacharcolon}\ succ{\isacharunderscore}rel{\isachardot}induct{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\isadigit{2}}\ head{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\isadigit{3}}\ head\ x\ xs{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}a\ {\isacharequal}\ head{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isasymnotin}\ set\ {\isacharparenleft}x{\isacharhash}xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isasymnotin}\ fst\ {\isacharbackquote}\ {\isacharparenleft}succ{\isacharunderscore}rel\ {\isacharparenleft}x{\isacharhash}xs{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ succ{\isacharunderscore}rel{\isacharunderscore}set{\isacharunderscore}fst\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}b{\isadigit{1}}\ {\isacharequal}\ b{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isadigit{3}}\ image{\isacharunderscore}iff\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}{\isacharparenleft}a{\isacharcomma}\ b{\isadigit{1}}{\isacharparenright}{\isacharcomma}\ {\isacharparenleft}a{\isacharcomma}\ b{\isadigit{2}}{\isacharparenright}{\isacharbraceright}\ {\isasymsubseteq}\ succ{\isacharunderscore}rel\ {\isacharparenleft}x{\isacharhash}xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}x{\isacharhash}xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}b{\isadigit{1}}\ {\isacharequal}\ b{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{3}}{\isachardot}IH{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ succ{\isacharunderscore}rel{\isacharunderscore}rem{\isacharunderscore}head{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharbraceleft}{\isacharparenleft}p{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}{\isachardot}\ p\ {\isasymnoteq}\ x{\isacharbraceright}\ {\isacharequal}\ succ{\isacharunderscore}rel\ xs{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ head{\isacharunderscore}notin{\isacharcolon}\ {\isachardoublequoteopen}x\ {\isasymnotin}\ fst\ {\isacharbackquote}\ succ{\isacharunderscore}rel\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ succ{\isacharunderscore}rel{\isacharunderscore}set{\isacharunderscore}fst{\isacharparenright}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ y\ \isakeyword{where}\ {\isachardoublequoteopen}{\isacharparenleft}x{\isacharcomma}\ y{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ xs{\isacharcomma}\ auto{\isacharparenright}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharparenleft}x{\isacharcomma}\ y{\isacharparenright}{\isacharbraceright}\ {\isasymunion}\ succ{\isacharunderscore}rel\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ calculation\ head{\isacharunderscore}notin\ image{\isacharunderscore}iff\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ xs{\isacharcomma}\ fastforce{\isacharplus}{\isacharparenright}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ this\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}n{\isachardot}\ {\isacharparenleft}x{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}\ {\isasymLongrightarrow}\ n\ {\isacharequal}\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Pair{\isacharunderscore}inject\ fst{\isacharunderscore}conv\ head{\isacharunderscore}notin\ image{\isacharunderscore}eqI\ insertE\ insert{\isacharunderscore}is{\isacharunderscore}Un{\isacharparenright}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}{\isacharparenleft}p{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}{\isachardot}\ p\ {\isasymnoteq}\ x{\isacharbraceright}\ {\isacharequal}\ succ{\isacharunderscore}rel\ {\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharminus}\ {\isacharbraceleft}{\isacharparenleft}x{\isacharcomma}\ y{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharminus}\ {\isacharbraceleft}{\isacharparenleft}x{\isacharcomma}\ y{\isacharparenright}{\isacharbraceright}\ {\isacharequal}\ succ{\isacharunderscore}rel\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ image{\isacharunderscore}iff\ calculation\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}{\isacharparenleft}p{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}{\isachardot}\ p\ {\isasymnoteq}\ x{\isacharbraceright}\ {\isacharequal}\ succ{\isacharunderscore}rel\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ succ{\isacharunderscore}rel{\isacharunderscore}swap{\isacharunderscore}head{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}ref\ {\isacharhash}\ list{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isacharparenleft}ref{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}ref\ {\isacharhash}\ list{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}oid\ {\isacharhash}\ list{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharparenleft}oid{\isacharcomma}\ n{\isacharparenright}{\isacharbraceright}\ {\isasymunion}\ succ{\isacharunderscore}rel\ list{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}cases\ list{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ list{\isacharparenright}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ this\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}n\ {\isacharequal}\ Some\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Un{\isacharunderscore}iff\ assms\ singletonI\ succ{\isacharunderscore}rel{\isachardot}simps{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ succ{\isacharunderscore}rel{\isacharunderscore}functional{\isacharparenright}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ succ{\isacharunderscore}rel{\isacharunderscore}insert{\isacharunderscore}alt{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}a\ {\isasymnoteq}\ ref{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}oid\ {\isacharhash}\ a\ {\isacharhash}\ b\ {\isacharhash}\ list{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}insert{\isacharunderscore}alt\ {\isacharparenleft}succ{\isacharunderscore}rel\ {\isacharparenleft}a\ {\isacharhash}\ b\ {\isacharhash}\ list{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\isacharparenleft}a{\isacharcomma}\ Some\ b{\isacharparenright}{\isacharbraceright}\ {\isasymunion}\ insert{\isacharunderscore}alt\ {\isacharparenleft}succ{\isacharunderscore}rel\ {\isacharparenleft}b\ {\isacharhash}\ list{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}{\isasymexists}n{\isachardot}\ {\isacharparenleft}ref{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}a\ {\isacharhash}\ b\ {\isacharhash}\ list{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}alt\ {\isacharparenleft}succ{\isacharunderscore}rel\ {\isacharparenleft}a\ {\isacharhash}\ b\ {\isacharhash}\ list{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\isacharparenleft}p{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}a\ {\isacharhash}\ b\ {\isacharhash}\ list{\isacharparenright}{\isachardot}\ p\ {\isasymnoteq}\ ref{\isacharbraceright}\ {\isasymunion}\ {\isacharbraceleft}{\isacharparenleft}ref{\isacharcomma}\ Some\ oid{\isacharparenright}{\isacharbraceright}\ {\isasymunion}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\isacharparenleft}i{\isacharcomma}\ n{\isacharparenright}{\isachardot}\ i\ {\isacharequal}\ oid\ {\isasymand}\ {\isacharparenleft}ref{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}a\ {\isacharhash}\ b\ {\isacharhash}\ list{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}{\isacharparenleft}p{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}a\ {\isacharhash}\ b\ {\isacharhash}\ list{\isacharparenright}{\isachardot}\ p\ {\isasymnoteq}\ ref{\isacharbraceright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\isacharparenleft}a{\isacharcomma}\ Some\ b{\isacharparenright}{\isacharbraceright}\ {\isasymunion}\ {\isacharbraceleft}{\isacharparenleft}p{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}b\ {\isacharhash}\ list{\isacharparenright}{\isachardot}\ p\ {\isasymnoteq}\ ref{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}alt\ {\isacharparenleft}succ{\isacharunderscore}rel\ {\isacharparenleft}b\ {\isacharhash}\ list{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\isacharparenleft}p{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}b\ {\isacharhash}\ list{\isacharparenright}{\isachardot}\ p\ {\isasymnoteq}\ ref{\isacharbraceright}\ {\isasymunion}\ {\isacharbraceleft}{\isacharparenleft}ref{\isacharcomma}\ Some\ oid{\isacharparenright}{\isacharbraceright}\ {\isasymunion}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\isacharparenleft}i{\isacharcomma}\ n{\isacharparenright}{\isachardot}\ i\ {\isacharequal}\ oid\ {\isasymand}\ {\isacharparenleft}ref{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}b\ {\isacharhash}\ list{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}n{\isachardot}\ {\isacharparenleft}ref{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}b\ {\isacharhash}\ list{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ True\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}{\isacharparenleft}i{\isacharcomma}\ n{\isacharparenright}{\isachardot}\ i\ {\isacharequal}\ oid\ {\isasymand}\ {\isacharparenleft}ref{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}a\ {\isacharhash}\ b\ {\isacharhash}\ list{\isacharparenright}{\isacharbraceright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\isacharparenleft}i{\isacharcomma}\ n{\isacharparenright}{\isachardot}\ i\ {\isacharequal}\ oid\ {\isasymand}\ {\isacharparenleft}ref{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}b\ {\isacharhash}\ list{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ succ{\isacharunderscore}rel{\isacharunderscore}insert{\isacharunderscore}head{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}ref\ {\isacharhash}\ list{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharparenleft}ref\ {\isacharhash}\ list{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ insert{\isacharunderscore}alt\ {\isacharparenleft}succ{\isacharunderscore}rel\ {\isacharparenleft}ref\ {\isacharhash}\ list{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ n\ \isakeyword{where}\ ref{\isacharunderscore}in{\isacharunderscore}rel{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}ref{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}ref\ {\isacharhash}\ list{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ list{\isacharcomma}\ auto{\isacharparenright}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ this\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}{\isacharparenleft}p{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}ref\ {\isacharhash}\ list{\isacharparenright}{\isachardot}\ p\ {\isasymnoteq}\ ref{\isacharbraceright}\ {\isacharequal}\ succ{\isacharunderscore}rel\ list{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ succ{\isacharunderscore}rel{\isacharunderscore}rem{\isacharunderscore}head\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}mono{\isacharunderscore}tags{\isacharcomma}\ lifting{\isacharparenright}{\isacharparenright}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}{\isacharparenleft}i{\isacharcomma}\ n{\isacharparenright}{\isachardot}\ i\ {\isacharequal}\ oid\ {\isasymand}\ {\isacharparenleft}ref{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}ref\ {\isacharhash}\ list{\isacharparenright}{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharparenleft}oid{\isacharcomma}\ n{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}nx{\isachardot}\ {\isacharparenleft}ref{\isacharcomma}\ nx{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}ref\ {\isacharhash}\ list{\isacharparenright}\ {\isasymLongrightarrow}\ nx\ {\isacharequal}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ succ{\isacharunderscore}rel{\isacharunderscore}functional\ ref{\isacharunderscore}in{\isacharunderscore}rel{\isacharparenright}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}{\isacharparenleft}i{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}ref\ {\isacharhash}\ list{\isacharparenright}{\isachardot}\ i\ {\isacharequal}\ ref{\isacharbraceright}\ {\isasymsubseteq}\ {\isacharbraceleft}{\isacharparenleft}ref{\isacharcomma}\ n{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}{\isacharparenleft}ref{\isacharcomma}\ n{\isacharparenright}{\isacharbraceright}\ {\isasymsubseteq}\ {\isacharbraceleft}{\isacharparenleft}i{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}ref\ {\isacharhash}\ list{\isacharparenright}{\isachardot}\ i\ {\isacharequal}\ ref{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ ref{\isacharunderscore}in{\isacharunderscore}rel{\isacharparenright}\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}alt\ {\isacharparenleft}succ{\isacharunderscore}rel\ {\isacharparenleft}ref\ {\isacharhash}\ list{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\isacharparenleft}p{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}ref\ {\isacharhash}\ list{\isacharparenright}{\isachardot}\ p\ {\isasymnoteq}\ ref{\isacharbraceright}\ {\isasymunion}\ {\isacharbraceleft}{\isacharparenleft}ref{\isacharcomma}\ Some\ oid{\isacharparenright}{\isacharbraceright}\ {\isasymunion}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\isacharparenleft}i{\isacharcomma}\ n{\isacharparenright}{\isachardot}\ i\ {\isacharequal}\ oid\ {\isasymand}\ {\isacharparenleft}ref{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}ref\ {\isacharhash}\ list{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}n{\isachardot}\ {\isacharparenleft}ref{\isacharcomma}\ n{\isacharparenright}\ {\isasymin}\ succ{\isacharunderscore}rel\ {\isacharparenleft}ref\ {\isacharhash}\ list{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ref{\isacharunderscore}in{\isacharunderscore}rel\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}alt\ {\isacharparenleft}succ{\isacharunderscore}rel\ {\isacharparenleft}ref\ {\isacharhash}\ list{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ succ{\isacharunderscore}rel\ list\ {\isasymunion}\ {\isacharbraceleft}{\isacharparenleft}ref{\isacharcomma}\ Some\ oid{\isacharparenright}{\isacharbraceright}\ {\isasymunion}\ {\isacharbraceleft}{\isacharparenleft}oid{\isacharcomma}\ n{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}oid\ {\isacharhash}\ list{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharparenleft}oid{\isacharcomma}\ n{\isacharparenright}{\isacharbraceright}\ {\isasymunion}\ succ{\isacharunderscore}rel\ list{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ ref{\isacharunderscore}in{\isacharunderscore}rel\ succ{\isacharunderscore}rel{\isacharunderscore}swap{\isacharunderscore}head\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}ref\ {\isacharhash}\ oid\ {\isacharhash}\ list{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharparenleft}ref{\isacharcomma}\ Some\ oid{\isacharparenright}{\isacharcomma}\ {\isacharparenleft}oid{\isacharcomma}\ n{\isacharparenright}{\isacharbraceright}\ {\isasymunion}\ succ{\isacharunderscore}rel\ list{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharparenleft}ref\ {\isacharhash}\ list{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ insert{\isacharunderscore}alt\ {\isacharparenleft}succ{\isacharunderscore}rel\ {\isacharparenleft}ref\ {\isacharhash}\ list{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ succ{\isacharunderscore}rel{\isacharunderscore}insert{\isacharunderscore}later{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharparenleft}b\ {\isacharhash}\ list{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ insert{\isacharunderscore}alt\ {\isacharparenleft}succ{\isacharunderscore}rel\ {\isacharparenleft}b\ {\isacharhash}\ list{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}a\ {\isasymnoteq}\ ref{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}a\ {\isacharhash}\ b\ {\isacharhash}\ list{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharparenleft}a\ {\isacharhash}\ b\ {\isacharhash}\ list{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ insert{\isacharunderscore}alt\ {\isacharparenleft}succ{\isacharunderscore}rel\ {\isacharparenleft}a\ {\isacharhash}\ b\ {\isacharhash}\ list{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}a\ {\isacharhash}\ b\ {\isacharhash}\ list{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharparenleft}a{\isacharcomma}\ Some\ b{\isacharparenright}{\isacharbraceright}\ {\isasymunion}\ succ{\isacharunderscore}rel\ {\isacharparenleft}b\ {\isacharhash}\ list{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}a\ {\isacharhash}\ b\ {\isacharhash}\ list{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a\ {\isacharhash}\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharparenleft}b\ {\isacharhash}\ list{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharparenleft}a\ {\isacharhash}\ b\ {\isacharhash}\ list{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\isacharparenleft}a{\isacharcomma}\ Some\ b{\isacharparenright}{\isacharbraceright}\ {\isasymunion}\ succ{\isacharunderscore}rel\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharparenleft}b\ {\isacharhash}\ list{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharparenleft}a\ {\isacharhash}\ b\ {\isacharhash}\ list{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\isacharparenleft}a{\isacharcomma}\ Some\ b{\isacharparenright}{\isacharbraceright}\ {\isasymunion}\ insert{\isacharunderscore}alt\ {\isacharparenleft}succ{\isacharunderscore}rel\ {\isacharparenleft}b\ {\isacharhash}\ list{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}alt\ {\isacharparenleft}succ{\isacharunderscore}rel\ {\isacharparenleft}a\ {\isacharhash}\ b\ {\isacharhash}\ list{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\isacharparenleft}a{\isacharcomma}\ Some\ b{\isacharparenright}{\isacharbraceright}\ {\isasymunion}\ insert{\isacharunderscore}alt\ {\isacharparenleft}succ{\isacharunderscore}rel\ {\isacharparenleft}b\ {\isacharhash}\ list{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ succ{\isacharunderscore}rel{\isacharunderscore}insert{\isacharunderscore}alt\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ succ{\isacharunderscore}rel{\isacharunderscore}insert{\isacharunderscore}Some{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}distinct\ list{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}insert{\isacharunderscore}spec\ list\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ insert{\isacharunderscore}alt\ {\isacharparenleft}succ{\isacharunderscore}rel\ list{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induction\ list{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ insert{\isacharunderscore}alt\ {\isacharparenleft}succ{\isacharunderscore}rel\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ list{\isacharparenright}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}a\ {\isacharhash}\ list{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharparenleft}a\ {\isacharhash}\ list{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ insert{\isacharunderscore}alt\ {\isacharparenleft}succ{\isacharunderscore}rel\ {\isacharparenleft}a\ {\isacharhash}\ list{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}a\ {\isacharequal}\ ref{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ succ{\isacharunderscore}rel{\isacharunderscore}insert{\isacharunderscore}head\ {\isacartoucheopen}distinct\ {\isacharparenleft}a\ {\isacharhash}\ list{\isacharparenright}{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isasymnoteq}\ ref{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}insert{\isacharunderscore}spec\ list\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ insert{\isacharunderscore}alt\ {\isacharparenleft}succ{\isacharunderscore}rel\ list{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isachardot}IH\ Cons{\isachardot}prems\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharparenleft}a\ {\isacharhash}\ list{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ insert{\isacharunderscore}alt\ {\isacharparenleft}succ{\isacharunderscore}rel\ {\isacharparenleft}a\ {\isacharhash}\ list{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ list{\isacharcomma}\ force{\isacharcomma}\ metis\ Cons{\isachardot}prems\ succ{\isacharunderscore}rel{\isacharunderscore}insert{\isacharunderscore}later{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The main result of this section, that insert\_spec and insert\_alt
are equivalent.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{theorem}\isamarkupfalse%
\ insert{\isacharunderscore}alt{\isacharunderscore}equivalent{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ ops{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}head\ {\isasymnotin}\ fst\ {\isacharbackquote}\ set\ ops{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymAnd}r{\isachardot}\ Some\ r\ {\isasymin}\ snd\ {\isacharbackquote}\ set\ ops\ {\isasymLongrightarrow}\ r\ {\isasymnoteq}\ head{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}head\ {\isacharhash}\ interp{\isacharunderscore}list\ ops{\isacharparenright}\ {\isacharequal}\ interp{\isacharunderscore}alt\ head\ ops{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induction\ ops\ rule{\isacharcolon}\ List{\isachardot}rev{\isacharunderscore}induct{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}head\ {\isacharhash}\ interp{\isacharunderscore}list\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}\ {\isacharequal}\ interp{\isacharunderscore}alt\ head\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ interp{\isacharunderscore}list{\isacharunderscore}def\ interp{\isacharunderscore}alt{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}snoc\ x\ xs{\isacharparenright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ IH{\isacharcolon}\ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}head\ {\isacharhash}\ interp{\isacharunderscore}list\ xs{\isacharparenright}\ {\isacharequal}\ interp{\isacharunderscore}alt\ head\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ snoc\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ distinct{\isacharunderscore}list{\isacharcolon}\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}head\ {\isacharhash}\ interp{\isacharunderscore}list\ xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}interp{\isacharunderscore}list\ xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ interp{\isacharunderscore}list{\isacharunderscore}distinct\ snoc{\isachardot}prems{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ {\isacharparenleft}interp{\isacharunderscore}list\ xs{\isacharparenright}\ {\isasymsubseteq}\ fst\ {\isacharbackquote}\ set\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ interp{\isacharunderscore}list{\isacharunderscore}subset\ snoc{\isachardot}prems{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}head\ {\isacharhash}\ interp{\isacharunderscore}list\ xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ snoc{\isachardot}prems{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ oid\ r\ \isakeyword{where}\ x{\isacharunderscore}pair{\isacharcolon}\ {\isachardoublequoteopen}x\ {\isacharequal}\ {\isacharparenleft}oid{\isacharcomma}\ r{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}succ{\isacharunderscore}rel\ {\isacharparenleft}head\ {\isacharhash}\ interp{\isacharunderscore}list\ {\isacharparenleft}xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ interp{\isacharunderscore}alt\ head\ {\isacharparenleft}xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}cases\ r{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ None\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}interp{\isacharunderscore}alt\ head\ {\isacharparenleft}xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}\ {\isacharequal}\ insert{\isacharunderscore}alt\ {\isacharparenleft}interp{\isacharunderscore}alt\ head\ xs{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ head{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ interp{\isacharunderscore}alt{\isacharunderscore}def\ None\ x{\isacharunderscore}pair{\isacharparenright}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ insert{\isacharunderscore}alt\ {\isacharparenleft}succ{\isacharunderscore}rel\ {\isacharparenleft}head\ {\isacharhash}\ interp{\isacharunderscore}list\ xs{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ head{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ IH{\isacharparenright}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ succ{\isacharunderscore}rel\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharparenleft}head\ {\isacharhash}\ interp{\isacharunderscore}list\ xs{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ head{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ distinct{\isacharunderscore}list\ succ{\isacharunderscore}rel{\isacharunderscore}insert{\isacharunderscore}Some\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ succ{\isacharunderscore}rel\ {\isacharparenleft}head\ {\isacharhash}\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharparenleft}interp{\isacharunderscore}list\ xs{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ None{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ succ{\isacharunderscore}rel\ {\isacharparenleft}head\ {\isacharhash}\ {\isacharparenleft}interp{\isacharunderscore}list\ {\isacharparenleft}xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ interp{\isacharunderscore}list{\isacharunderscore}tail{\isacharunderscore}unfold\ None\ x{\isacharunderscore}pair{\isacharparenright}\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Some\ ref{\isacharparenright}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}ref\ {\isasymnoteq}\ head{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ Some\ snoc{\isachardot}prems{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ x{\isacharunderscore}pair{\isacharparenright}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}interp{\isacharunderscore}alt\ head\ {\isacharparenleft}xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}\ {\isacharequal}\ insert{\isacharunderscore}alt\ {\isacharparenleft}interp{\isacharunderscore}alt\ head\ xs{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ interp{\isacharunderscore}alt{\isacharunderscore}def\ Some\ x{\isacharunderscore}pair{\isacharparenright}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ insert{\isacharunderscore}alt\ {\isacharparenleft}succ{\isacharunderscore}rel\ {\isacharparenleft}head\ {\isacharhash}\ interp{\isacharunderscore}list\ xs{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ IH{\isacharparenright}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ succ{\isacharunderscore}rel\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharparenleft}head\ {\isacharhash}\ interp{\isacharunderscore}list\ xs{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ distinct{\isacharunderscore}list\ succ{\isacharunderscore}rel{\isacharunderscore}insert{\isacharunderscore}Some\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ succ{\isacharunderscore}rel\ {\isacharparenleft}head\ {\isacharhash}\ {\isacharparenleft}insert{\isacharunderscore}spec\ {\isacharparenleft}interp{\isacharunderscore}list\ xs{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ ref{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}ref\ {\isasymnoteq}\ head{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ succ{\isacharunderscore}rel\ {\isacharparenleft}head\ {\isacharhash}\ {\isacharparenleft}interp{\isacharunderscore}list\ {\isacharparenleft}xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ interp{\isacharunderscore}list{\isacharunderscore}tail{\isacharunderscore}unfold\ Some\ x{\isacharunderscore}pair{\isacharparenright}\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isamarkupsubsection{The list\_order predicate%
}
\isamarkuptrue%
%
\begin{isamarkuptext}%
``list\_order \emph{ops x y}'' holds iff, after interpreting the list of
insertion operations \emph{ops}, the list element with ID \emph{x} appears
before the list element with ID \emph{y} in the resulting list. We prove several
lemmas about this predicate; in particular, that executing additional insertion
operations does not change the relative ordering of existing list elements.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ list{\isacharunderscore}order\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}{\isacharprime}oid{\isacharcolon}{\isacharcolon}{\isacharbraceleft}linorder{\isacharbraceright}\ {\isasymtimes}\ {\isacharprime}oid\ option{\isacharparenright}\ list\ {\isasymRightarrow}\ {\isacharprime}oid\ {\isasymRightarrow}\ {\isacharprime}oid\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}list{\isacharunderscore}order\ ops\ x\ y\ {\isasymequiv}\ {\isasymexists}xs\ ys\ zs{\isachardot}\ interp{\isacharunderscore}list\ ops\ {\isacharequal}\ xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}\ {\isacharat}\ ys\ {\isacharat}\ {\isacharbrackleft}y{\isacharbrackright}\ {\isacharat}\ zs{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}orderI{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ ops\ {\isacharequal}\ xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}\ {\isacharat}\ ys\ {\isacharat}\ {\isacharbrackleft}y{\isacharbrackright}\ {\isacharat}\ zs{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}list{\isacharunderscore}order\ ops\ x\ y{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ list{\isacharunderscore}order{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}orderE{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}list{\isacharunderscore}order\ ops\ x\ y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymexists}xs\ ys\ zs{\isachardot}\ interp{\isacharunderscore}list\ ops\ {\isacharequal}\ xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}\ {\isacharat}\ ys\ {\isacharat}\ {\isacharbrackleft}y{\isacharbrackright}\ {\isacharat}\ zs{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ list{\isacharunderscore}order{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}order{\isacharunderscore}memb{\isadigit{1}}{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}list{\isacharunderscore}order\ ops\ x\ y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}interp{\isacharunderscore}list\ ops{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ list{\isacharunderscore}order{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}order{\isacharunderscore}memb{\isadigit{2}}{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}list{\isacharunderscore}order\ ops\ x\ y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}y\ {\isasymin}\ set\ {\isacharparenleft}interp{\isacharunderscore}list\ ops{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ list{\isacharunderscore}order{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}order{\isacharunderscore}trans{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ op{\isacharunderscore}list{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}list{\isacharunderscore}order\ op{\isacharunderscore}list\ x\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}list{\isacharunderscore}order\ op{\isacharunderscore}list\ y\ z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}list{\isacharunderscore}order\ op{\isacharunderscore}list\ x\ z{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ xxs\ xys\ xzs\ \isakeyword{where}\ {\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ op{\isacharunderscore}list\ {\isacharequal}\ {\isacharparenleft}xxs{\isacharat}{\isacharbrackleft}x{\isacharbrackright}{\isacharat}xys{\isacharparenright}{\isacharat}{\isacharparenleft}y{\isacharhash}xzs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ list{\isacharunderscore}order{\isacharunderscore}def\ interp{\isacharunderscore}list{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ yxs\ yys\ yzs\ \isakeyword{where}\ {\isadigit{2}}{\isacharcolon}\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ op{\isacharunderscore}list\ {\isacharequal}\ yxs{\isacharat}y{\isacharhash}{\isacharparenleft}yys{\isacharat}{\isacharbrackleft}z{\isacharbrackright}{\isacharat}yzs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ list{\isacharunderscore}order{\isacharunderscore}def\ interp{\isacharunderscore}list{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isadigit{3}}{\isacharcolon}\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}interp{\isacharunderscore}list\ op{\isacharunderscore}list{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ interp{\isacharunderscore}list{\isacharunderscore}distinct\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}xzs\ {\isacharequal}\ yys{\isacharat}{\isacharbrackleft}z{\isacharbrackright}{\isacharat}yzs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ distinct{\isacharunderscore}list{\isacharunderscore}split{\isacharbrackleft}OF\ {\isadigit{3}}{\isacharcomma}\ OF\ {\isadigit{2}}{\isacharcomma}\ OF\ {\isadigit{1}}{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ op{\isacharunderscore}list\ {\isacharequal}\ xxs{\isacharat}{\isacharbrackleft}x{\isacharbrackright}{\isacharat}xys{\isacharat}{\isacharbrackleft}y{\isacharbrackright}{\isacharat}yys{\isacharat}{\isacharbrackleft}z{\isacharbrackright}{\isacharat}yzs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}\ {\isadigit{2}}\ {\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ clarsimp\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}list{\isacharunderscore}order\ op{\isacharunderscore}list\ x\ z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ append{\isachardot}assoc\ list{\isacharunderscore}orderI{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ insert{\isacharunderscore}preserves{\isacharunderscore}order{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ ops{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ rest{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}rest\ {\isacharequal}\ before\ {\isacharat}\ after{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}ops\ \ {\isacharequal}\ before\ {\isacharat}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharhash}\ after{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymexists}xs\ ys\ zs{\isachardot}\ interp{\isacharunderscore}list\ rest\ {\isacharequal}\ xs\ {\isacharat}\ zs\ {\isasymand}\ interp{\isacharunderscore}list\ ops\ {\isacharequal}\ xs\ {\isacharat}\ ys\ {\isacharat}\ zs{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induction\ after\ arbitrary{\isacharcolon}\ rest\ ops\ rule{\isacharcolon}\ List{\isachardot}rev{\isacharunderscore}induct{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ ops\ {\isacharequal}\ insert{\isacharunderscore}spec\ {\isacharparenleft}interp{\isacharunderscore}list\ before{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ interp{\isacharunderscore}list{\isacharunderscore}tail{\isacharunderscore}unfold{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}xs\ ys\ zs{\isachardot}\ interp{\isacharunderscore}list\ rest\ {\isacharequal}\ xs\ {\isacharat}\ zs\ {\isasymand}\ interp{\isacharunderscore}list\ ops\ {\isacharequal}\ xs\ {\isacharat}\ ys\ {\isacharat}\ zs{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}cases\ ref{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ None\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ rest\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharat}\ {\isacharparenleft}interp{\isacharunderscore}list\ before{\isacharparenright}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ interp{\isacharunderscore}list\ ops\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharat}\ {\isacharbrackleft}oid{\isacharbrackright}\ {\isacharat}\ {\isacharparenleft}interp{\isacharunderscore}list\ before{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}\ Nil{\isachardot}prems{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Some\ a{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}a\ {\isasymin}\ set\ {\isacharparenleft}interp{\isacharunderscore}list\ before{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ xs\ ys\ \isakeyword{where}\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ before\ {\isacharequal}\ xs\ {\isacharat}\ ys\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ insert{\isacharunderscore}spec\ {\isacharparenleft}interp{\isacharunderscore}list\ before{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ oid\ {\isacharhash}\ ys{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ insert{\isacharunderscore}somewhere\ Some\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ rest\ {\isacharequal}\ xs\ {\isacharat}\ ys\ {\isasymand}\ interp{\isacharunderscore}list\ ops\ {\isacharequal}\ xs\ {\isacharat}\ {\isacharbrackleft}oid{\isacharbrackright}\ {\isacharat}\ ys{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}\ Nil{\isachardot}prems{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ ops\ {\isacharequal}\ {\isacharparenleft}interp{\isacharunderscore}list\ rest{\isacharparenright}\ {\isacharat}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharat}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ insert{\isacharunderscore}spec{\isacharunderscore}nonex\ {\isadigit{1}}\ Nil{\isachardot}prems{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ Some\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}snoc\ oper\ op{\isacharunderscore}list{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ {\isacharparenleft}{\isacharparenleft}before\ {\isacharat}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharhash}\ op{\isacharunderscore}list{\isacharparenright}\ {\isacharat}\ {\isacharbrackleft}oper{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ {\isacharparenleft}{\isacharparenleft}before\ {\isacharat}\ op{\isacharunderscore}list{\isacharparenright}\ {\isacharat}\ {\isacharbrackleft}oper{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ ops{\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ {\isacharparenleft}before\ {\isacharat}\ op{\isacharunderscore}list{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ ops{\isadigit{2}}{\isacharcolon}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ {\isacharparenleft}before\ {\isacharat}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharhash}\ op{\isacharunderscore}list{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ insert{\isacharunderscore}ops{\isacharunderscore}appendD\ \isacommand{by}\isamarkupfalse%
\ blast{\isacharplus}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ xs\ ys\ zs\ \isakeyword{where}\ IH{\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ {\isacharparenleft}before\ {\isacharat}\ op{\isacharunderscore}list{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ zs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ IH{\isadigit{2}}{\isacharcolon}\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ {\isacharparenleft}before\ {\isacharat}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharhash}\ op{\isacharunderscore}list{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ ys\ {\isacharat}\ zs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ snoc{\isachardot}IH\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ i{\isadigit{2}}\ r{\isadigit{2}}\ \isakeyword{where}\ {\isachardoublequoteopen}oper\ {\isacharequal}\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ r{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}xs\ ys\ zs{\isachardot}\ interp{\isacharunderscore}list\ rest\ {\isacharequal}\ xs\ {\isacharat}\ zs\ {\isasymand}\ interp{\isacharunderscore}list\ ops\ {\isacharequal}\ xs\ {\isacharat}\ ys\ {\isacharat}\ zs{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}cases\ r{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ None\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ {\isacharparenleft}before\ {\isacharat}\ op{\isacharunderscore}list\ {\isacharat}\ {\isacharbrackleft}oper{\isacharbrackright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}i{\isadigit{2}}\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharat}\ zs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ IH{\isadigit{1}}\ {\isacartoucheopen}oper\ {\isacharequal}\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ r{\isadigit{2}}{\isacharparenright}{\isacartoucheclose}\ append{\isachardot}assoc\ append{\isacharunderscore}Cons\ insert{\isacharunderscore}spec{\isachardot}simps{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ interp{\isacharunderscore}list{\isacharunderscore}tail{\isacharunderscore}unfold{\isacharparenright}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ {\isacharparenleft}before\ {\isacharat}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharhash}\ op{\isacharunderscore}list\ {\isacharat}\ {\isacharbrackleft}oper{\isacharbrackright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}i{\isadigit{2}}\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharat}\ ys\ {\isacharat}\ zs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ IH{\isadigit{2}}\ None\ {\isacartoucheopen}oper\ {\isacharequal}\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ r{\isadigit{2}}{\isacharparenright}{\isacartoucheclose}\ append{\isachardot}assoc\ append{\isacharunderscore}Cons\ insert{\isacharunderscore}spec{\isachardot}simps{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ interp{\isacharunderscore}list{\isacharunderscore}tail{\isacharunderscore}unfold{\isacharparenright}\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ snoc{\isachardot}prems{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ snoc{\isachardot}prems{\isacharparenleft}{\isadigit{4}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Some\ r{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ {\isacharparenleft}before\ {\isacharat}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharhash}\ op{\isacharunderscore}list\ {\isacharat}\ {\isacharbrackleft}{\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ r{\isadigit{2}}{\isacharparenright}{\isacharbrackright}{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ insert{\isacharunderscore}spec\ {\isacharparenleft}xs\ {\isacharat}\ ys\ {\isacharat}\ zs{\isacharparenright}\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ Some\ r{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ IH{\isadigit{2}}\ append{\isachardot}assoc\ append{\isacharunderscore}Cons\ interp{\isacharunderscore}list{\isacharunderscore}tail{\isacharunderscore}unfold{\isacharparenright}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isadigit{2}}{\isacharcolon}\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ {\isacharparenleft}before\ {\isacharat}\ op{\isacharunderscore}list\ {\isacharat}\ {\isacharbrackleft}{\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ r{\isadigit{2}}{\isacharparenright}{\isacharbrackright}{\isacharparenright}\ {\isacharequal}\ insert{\isacharunderscore}spec\ {\isacharparenleft}xs\ {\isacharat}\ zs{\isacharparenright}\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ Some\ r{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ IH{\isadigit{1}}\ append{\isachardot}assoc\ interp{\isacharunderscore}list{\isacharunderscore}tail{\isacharunderscore}unfold\ Some{\isacharparenright}\isanewline
\ \ \ \ \isacommand{consider}\isamarkupfalse%
\ {\isacharparenleft}r{\isacharunderscore}xs{\isacharparenright}\ {\isachardoublequoteopen}r\ {\isasymin}\ set\ xs{\isachardoublequoteclose}\ {\isacharbar}\ {\isacharparenleft}r{\isacharunderscore}ys{\isacharparenright}\ {\isachardoublequoteopen}r\ {\isasymin}\ set\ ys{\isachardoublequoteclose}\ {\isacharbar}\ {\isacharparenleft}r{\isacharunderscore}zs{\isacharparenright}\ {\isachardoublequoteopen}r\ {\isasymin}\ set\ zs{\isachardoublequoteclose}\ {\isacharbar}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}r{\isacharunderscore}nonex{\isacharparenright}\ {\isachardoublequoteopen}r\ {\isasymnotin}\ set\ {\isacharparenleft}xs\ {\isacharat}\ ys\ {\isacharat}\ zs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}xs\ ys\ zs{\isachardot}\ interp{\isacharunderscore}list\ rest\ {\isacharequal}\ xs\ {\isacharat}\ zs\ {\isasymand}\ interp{\isacharunderscore}list\ ops\ {\isacharequal}\ xs\ {\isacharat}\ ys\ {\isacharat}\ zs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}cases{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ r{\isacharunderscore}xs\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ this\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}xs\ {\isacharat}\ ys\ {\isacharat}\ zs{\isacharparenright}\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ Some\ r{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ Some\ r{\isacharparenright}{\isacharparenright}\ {\isacharat}\ ys\ {\isacharat}\ zs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}meson\ insert{\isacharunderscore}first{\isacharunderscore}part{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}xs\ {\isacharat}\ zs{\isacharparenright}\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ Some\ r{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ Some\ r{\isacharparenright}{\isacharparenright}\ {\isacharat}\ zs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}meson\ r{\isacharunderscore}xs\ insert{\isacharunderscore}first{\isacharunderscore}part{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}\ {\isadigit{2}}\ {\isacartoucheopen}oper\ {\isacharequal}\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ r{\isadigit{2}}{\isacharparenright}{\isacartoucheclose}\ snoc{\isachardot}prems\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ r{\isacharunderscore}ys\isanewline
\ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}r\ {\isasymnotin}\ set\ xs{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}r\ {\isasymnotin}\ set\ zs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ IH{\isadigit{2}}\ ops{\isadigit{2}}\ interp{\isacharunderscore}list{\isacharunderscore}distinct\ \isacommand{by}\isamarkupfalse%
\ force{\isacharplus}\isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ this\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}xs\ {\isacharat}\ ys\ {\isacharat}\ zs{\isacharparenright}\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ Some\ r{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ xs\ {\isacharat}\ {\isacharparenleft}insert{\isacharunderscore}spec\ ys\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ Some\ r{\isacharparenright}{\isacharparenright}\ {\isacharat}\ zs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ insert{\isacharunderscore}first{\isacharunderscore}part\ insert{\isacharunderscore}second{\isacharunderscore}part\ insert{\isacharunderscore}spec{\isacharunderscore}nonex\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Some\ UnE\ r{\isacharunderscore}ys\ set{\isacharunderscore}append{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}xs\ {\isacharat}\ zs{\isacharparenright}\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ Some\ r{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ zs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ Some\ calculation{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ calculation{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}\ {\isadigit{2}}\ {\isacartoucheopen}oper\ {\isacharequal}\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ r{\isadigit{2}}{\isacharparenright}{\isacartoucheclose}\ snoc{\isachardot}prems\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ r{\isacharunderscore}zs\isanewline
\ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}r\ {\isasymnotin}\ set\ xs{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}r\ {\isasymnotin}\ set\ ys{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ IH{\isadigit{2}}\ ops{\isadigit{2}}\ interp{\isacharunderscore}list{\isacharunderscore}distinct\ \isacommand{by}\isamarkupfalse%
\ force{\isacharplus}\isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ this\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}xs\ {\isacharat}\ ys\ {\isacharat}\ zs{\isacharparenright}\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ Some\ r{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ xs\ {\isacharat}\ ys\ {\isacharat}\ {\isacharparenleft}insert{\isacharunderscore}spec\ zs\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ Some\ r{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Some\ UnE\ insert{\isacharunderscore}second{\isacharunderscore}part\ insert{\isacharunderscore}spec{\isacharunderscore}nonex\ set{\isacharunderscore}append{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}xs\ {\isacharat}\ zs{\isacharparenright}\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ Some\ r{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ {\isacharparenleft}insert{\isacharunderscore}spec\ zs\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ Some\ r{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ r{\isacharunderscore}zs\ calculation{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ insert{\isacharunderscore}second{\isacharunderscore}part{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}\ {\isadigit{2}}\ {\isacartoucheopen}oper\ {\isacharequal}\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ r{\isadigit{2}}{\isacharparenright}{\isacartoucheclose}\ snoc{\isachardot}prems\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ r{\isacharunderscore}nonex\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}xs\ {\isacharat}\ ys\ {\isacharat}\ zs{\isacharparenright}\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ Some\ r{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ ys\ {\isacharat}\ zs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}xs\ {\isacharat}\ zs{\isacharparenright}\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ Some\ r{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ zs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ r{\isacharunderscore}nonex\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}\ {\isadigit{2}}\ {\isacartoucheopen}oper\ {\isacharequal}\ {\isacharparenleft}i{\isadigit{2}}{\isacharcomma}\ r{\isadigit{2}}{\isacharparenright}{\isacartoucheclose}\ snoc{\isachardot}prems\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ distinct{\isacharunderscore}fst{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}map\ fst\ A{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}distinct\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induction\ A{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ subset{\isacharunderscore}distinct{\isacharunderscore}le{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}set\ A\ {\isasymsubseteq}\ set\ B{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}distinct\ A{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}distinct\ B{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}length\ A\ {\isasymle}\ length\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induction\ B\ arbitrary{\isacharcolon}\ A{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ A\ {\isasymle}\ length\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ B{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ A\ {\isasymle}\ length\ {\isacharparenleft}a\ {\isacharhash}\ B{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}a\ {\isasymin}\ set\ A{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ {\isacharparenleft}remove{\isadigit{1}}\ a\ A{\isacharparenright}\ {\isasymsubseteq}\ set\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isachardot}prems\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ {\isacharparenleft}remove{\isadigit{1}}\ a\ A{\isacharparenright}\ {\isasymle}\ length\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isachardot}IH\ Cons{\isachardot}prems\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ A\ {\isasymle}\ length\ {\isacharparenleft}a\ {\isacharhash}\ B{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ True\ length{\isacharunderscore}remove{\isadigit{1}}{\isacharparenright}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ A\ {\isasymsubseteq}\ set\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isachardot}prems\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ A\ {\isasymle}\ length\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isachardot}IH\ Cons{\isachardot}prems\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ A\ {\isasymle}\ length\ {\isacharparenleft}a\ {\isacharhash}\ B{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ set{\isacharunderscore}subset{\isacharunderscore}length{\isacharunderscore}eq{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}set\ A\ {\isasymsubseteq}\ set\ B{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}length\ B\ {\isasymle}\ length\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}distinct\ A{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}distinct\ B{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}set\ A\ {\isacharequal}\ set\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ A\ {\isasymle}\ length\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ subset{\isacharunderscore}distinct{\isacharunderscore}le{\isacharparenright}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ this\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharparenleft}set\ A{\isacharparenright}\ {\isacharequal}\ card\ {\isacharparenleft}set\ B{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ distinct{\isacharunderscore}card\ le{\isacharunderscore}antisym{\isacharparenright}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ A\ {\isacharequal}\ set\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ card{\isacharunderscore}subset{\isacharunderscore}eq{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ length{\isacharunderscore}diff{\isacharunderscore}Suc{\isacharunderscore}exists{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}length\ xs\ {\isacharminus}\ length\ ys\ {\isacharequal}\ Suc\ m{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}set\ ys\ {\isasymsubseteq}\ set\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}distinct\ ys{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}distinct\ xs{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymexists}e{\isachardot}\ e\ {\isasymin}\ set\ xs\ {\isasymand}\ e\ {\isasymnotin}\ set\ ys{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induction\ xs\ arbitrary{\isacharcolon}\ ys{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}e{\isachardot}\ e\ {\isasymin}\ set\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymand}\ e\ {\isasymnotin}\ set\ ys{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ xs{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}e{\isachardot}\ e\ {\isasymin}\ set\ {\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isasymand}\ e\ {\isasymnotin}\ set\ ys{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}a\ {\isasymin}\ set\ ys{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ IH{\isacharcolon}\ {\isachardoublequoteopen}{\isasymexists}e{\isachardot}\ e\ {\isasymin}\ set\ xs\ {\isasymand}\ e\ {\isasymnotin}\ set\ {\isacharparenleft}remove{\isadigit{1}}\ a\ ys{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ xs\ {\isacharminus}\ length\ {\isacharparenleft}remove{\isadigit{1}}\ a\ ys{\isacharparenright}\ {\isacharequal}\ Suc\ m{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Cons{\isachardot}prems{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ One{\isacharunderscore}nat{\isacharunderscore}def\ Suc{\isacharunderscore}pred\ True\ diff{\isacharunderscore}Suc{\isacharunderscore}Suc\ length{\isacharunderscore}Cons\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ length{\isacharunderscore}pos{\isacharunderscore}if{\isacharunderscore}in{\isacharunderscore}set\ length{\isacharunderscore}remove{\isadigit{1}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ {\isacharparenleft}remove{\isadigit{1}}\ a\ ys{\isacharparenright}\ {\isasymsubseteq}\ set\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isachardot}prems\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}meson\ Cons{\isachardot}IH\ Cons{\isachardot}prems\ distinct{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ distinct{\isacharunderscore}remove{\isadigit{1}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ ys\ {\isacharminus}\ {\isacharbraceleft}a{\isacharbraceright}\ {\isasymsubseteq}\ set\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isachardot}prems{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}e{\isachardot}\ e\ {\isasymin}\ set\ {\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isasymand}\ e\ {\isasymnotin}\ set\ ys{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ Cons{\isachardot}prems{\isacharparenleft}{\isadigit{4}}{\isacharparenright}\ distinct{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ in{\isacharunderscore}set{\isacharunderscore}remove{\isadigit{1}}\ set{\isacharunderscore}subset{\isacharunderscore}Cons\ subsetCE{\isacharparenright}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}e{\isachardot}\ e\ {\isasymin}\ set\ {\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isasymand}\ e\ {\isasymnotin}\ set\ ys{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ app{\isacharunderscore}length{\isacharunderscore}lt{\isacharunderscore}exists{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}xsa\ {\isacharat}\ zsa\ {\isacharequal}\ xs\ {\isacharat}\ ys{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}length\ xsa\ {\isasymle}\ length\ xs{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}xsa\ {\isacharat}\ {\isacharparenleft}drop\ {\isacharparenleft}length\ xsa{\isacharparenright}\ xs{\isacharparenright}\ {\isacharequal}\ xs{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induction\ xsa\ arbitrary{\isacharcolon}\ xs\ zsa\ ys{\isacharcomma}\ simp{\isacharcomma}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ metis\ append{\isacharunderscore}eq{\isacharunderscore}append{\isacharunderscore}conv{\isacharunderscore}if\ append{\isacharunderscore}take{\isacharunderscore}drop{\isacharunderscore}id{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}order{\isacharunderscore}monotonic{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ A{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}set\ A\ {\isasymsubseteq}\ set\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}list{\isacharunderscore}order\ A\ x\ y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}list{\isacharunderscore}order\ B\ x\ y{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induction\ rule{\isacharcolon}\ measure{\isacharunderscore}induct{\isacharunderscore}rule{\isacharbrackleft}\isakeyword{where}\ f{\isacharequal}{\isachardoublequoteopen}{\isasymlambda}x{\isachardot}\ {\isacharparenleft}length\ x\ {\isacharminus}\ length\ A{\isacharparenright}{\isachardoublequoteclose}{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}less\ xa{\isacharparenright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}map\ fst\ A{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}map\ fst\ xa{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ {\isachardoublequoteopen}sorted\ {\isacharparenleft}map\ fst\ A{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}sorted\ {\isacharparenleft}map\ fst\ xa{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ less{\isachardot}prems\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ insert{\isacharunderscore}ops{\isacharunderscore}def\ spec{\isacharunderscore}ops{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}distinct\ A{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}distinct\ xa{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ distinct{\isacharunderscore}fst{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}list{\isacharunderscore}order\ xa\ x\ y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}length\ xa\ {\isacharminus}\ length\ A{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ A\ {\isacharequal}\ set\ xa{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ set{\isacharunderscore}subset{\isacharunderscore}length{\isacharunderscore}eq\ less{\isachardot}prems{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ {\isacartoucheopen}distinct\ A{\isacartoucheclose}\ {\isacartoucheopen}distinct\ xa{\isacartoucheclose}\ diff{\isacharunderscore}is{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}eq\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}A\ {\isacharequal}\ xa{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}distinct\ {\isacharparenleft}map\ fst\ A{\isacharparenright}{\isacartoucheclose}\ {\isacartoucheopen}distinct\ {\isacharparenleft}map\ fst\ xa{\isacharparenright}{\isacartoucheclose}\isanewline
\ \ \ \ \ \ \ \ {\isacartoucheopen}sorted\ {\isacharparenleft}map\ fst\ A{\isacharparenright}{\isacartoucheclose}\ {\isacartoucheopen}sorted\ {\isacharparenleft}map\ fst\ xa{\isacharparenright}{\isacartoucheclose}\ map{\isacharunderscore}sorted{\isacharunderscore}distinct{\isacharunderscore}set{\isacharunderscore}unique\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ distinct{\isacharunderscore}map\ less{\isachardot}prems{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ subset{\isacharunderscore}Un{\isacharunderscore}eq{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}list{\isacharunderscore}order\ xa\ x\ y{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ less{\isachardot}prems{\isacharparenleft}{\isadigit{4}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Suc\ nat{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ e\ \isakeyword{where}\ {\isachardoublequoteopen}e\ {\isasymin}\ set\ xa{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}e\ {\isasymnotin}\ set\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ length{\isacharunderscore}diff{\isacharunderscore}Suc{\isacharunderscore}exists\ {\isacartoucheopen}distinct\ A{\isacartoucheclose}\ {\isacartoucheopen}distinct\ xa{\isacartoucheclose}\ less{\isachardot}prems{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ IH{\isacharcolon}\ {\isachardoublequoteopen}list{\isacharunderscore}order\ {\isacharparenleft}remove{\isadigit{1}}\ e\ xa{\isacharparenright}\ x\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ {\isacharparenleft}remove{\isadigit{1}}\ e\ xa{\isacharparenright}\ {\isacharminus}\ length\ A\ {\isacharless}\ Suc\ nat{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ diff{\isacharunderscore}Suc{\isacharunderscore}{\isadigit{1}}\ diff{\isacharunderscore}commute\ length{\isacharunderscore}remove{\isadigit{1}}\ less{\isacharunderscore}Suc{\isacharunderscore}eq\ Suc\ {\isacartoucheopen}e\ {\isasymin}\ set\ xa{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ {\isacharparenleft}remove{\isadigit{1}}\ e\ xa{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ insert{\isacharunderscore}ops{\isacharunderscore}remove{\isadigit{1}}\ less{\isachardot}prems{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ A\ {\isasymsubseteq}\ set\ {\isacharparenleft}remove{\isadigit{1}}\ e\ xa{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharcomma}\ lifting{\isacharparenright}\ {\isacartoucheopen}e\ {\isasymnotin}\ set\ A{\isacartoucheclose}\ in{\isacharunderscore}set{\isacharunderscore}remove{\isadigit{1}}\ less{\isachardot}prems{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ set{\isacharunderscore}rev{\isacharunderscore}mp\ subsetI{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ Suc\ less{\isachardot}IH\ less{\isachardot}prems{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ less{\isachardot}prems{\isacharparenleft}{\isadigit{4}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ xs\ ys\ zs\ \isakeyword{where}\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ {\isacharparenleft}remove{\isadigit{1}}\ e\ xa{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}\ x\ {\isacharhash}\ ys\ {\isacharat}\ y\ {\isacharhash}\ zs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ list{\isacharunderscore}order{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ oid\ ref\ \isakeyword{where}\ e{\isacharunderscore}pair{\isacharcolon}\ {\isachardoublequoteopen}e\ {\isacharequal}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ ps\ ss\ \isakeyword{where}\ xa{\isacharunderscore}split{\isacharcolon}\ {\isachardoublequoteopen}xa\ {\isacharequal}\ ps\ {\isacharat}\ {\isacharbrackleft}e{\isacharbrackright}\ {\isacharat}\ ss{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}e\ {\isasymnotin}\ set\ ps{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ split{\isacharunderscore}list{\isacharunderscore}first\ {\isacartoucheopen}e\ {\isasymin}\ set\ xa{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}remove{\isadigit{1}}\ e\ {\isacharparenleft}ps\ {\isacharat}\ e\ {\isacharhash}\ ss{\isacharparenright}\ {\isacharequal}\ ps\ {\isacharat}\ ss{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ remove{\isadigit{1}}{\isacharunderscore}append{\isacharparenright}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ this\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ {\isacharparenleft}ps\ {\isacharat}\ ss{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ {\isacharparenleft}ps\ {\isacharat}\ e\ {\isacharhash}\ ss{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ xa{\isacharunderscore}split\ less{\isachardot}prems{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ append{\isacharunderscore}Cons\ append{\isacharunderscore}Nil\ insert{\isacharunderscore}ops{\isacharunderscore}remove{\isadigit{1}}{\isacharcomma}\ auto{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ xsa\ ysa\ zsa\ \isakeyword{where}\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ {\isacharparenleft}ps\ {\isacharat}\ ss{\isacharparenright}\ {\isacharequal}\ xsa\ {\isacharat}\ zsa{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeyword{and}\ interp{\isacharunderscore}xa{\isacharcolon}\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ {\isacharparenleft}ps\ {\isacharat}\ {\isacharparenleft}oid{\isacharcomma}\ ref{\isacharparenright}\ {\isacharhash}\ ss{\isacharparenright}\ {\isacharequal}\ xsa\ {\isacharat}\ ysa\ {\isacharat}\ zsa{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ insert{\isacharunderscore}preserves{\isacharunderscore}order\ e{\isacharunderscore}pair\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ xsa{\isacharunderscore}zsa{\isacharcolon}\ {\isachardoublequoteopen}xsa\ {\isacharat}\ zsa\ {\isacharequal}\ xs\ {\isacharat}\ x\ {\isacharhash}\ ys\ {\isacharat}\ y\ {\isacharhash}\ zs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ interp{\isacharunderscore}list{\isacharunderscore}def\ remove{\isadigit{1}}{\isacharunderscore}append\ calculation\ xa{\isacharunderscore}split\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}list{\isacharunderscore}order\ xa\ x\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}length\ xsa\ {\isasymle}\ length\ xs{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ ts\ \isakeyword{where}\ {\isachardoublequoteopen}xsa{\isacharat}ts\ {\isacharequal}\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ app{\isacharunderscore}length{\isacharunderscore}lt{\isacharunderscore}exists\ xsa{\isacharunderscore}zsa\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ xa\ {\isacharequal}\ {\isacharparenleft}xsa\ {\isacharat}\ ysa\ {\isacharat}\ ts{\isacharparenright}\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}\ {\isacharat}\ ys\ {\isacharat}\ {\isacharbrackleft}y{\isacharbrackright}\ {\isacharat}\ zs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ calculation\ xa{\isacharunderscore}split\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}list{\isacharunderscore}order\ xa\ x\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ list{\isacharunderscore}order{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}list{\isacharunderscore}order\ xa\ x\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}length\ xsa\ {\isasymle}\ length\ {\isacharparenleft}xs\ {\isacharat}\ x\ {\isacharhash}\ ys{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ xsa{\isacharunderscore}zsa{\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}xsa\ {\isacharat}\ zsa\ {\isacharequal}\ {\isacharparenleft}xs\ {\isacharat}\ x\ {\isacharhash}\ ys{\isacharparenright}\ {\isacharat}\ {\isacharparenleft}y\ {\isacharhash}\ zs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ xsa{\isacharunderscore}zsa{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ us\ \isakeyword{where}\ {\isachardoublequoteopen}xsa\ {\isacharat}\ us\ {\isacharequal}\ xs\ {\isacharat}\ x\ {\isacharhash}\ ys{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ app{\isacharunderscore}length{\isacharunderscore}lt{\isacharunderscore}exists\ True\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ this\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}xs\ {\isacharat}\ x\ {\isacharhash}\ {\isacharparenleft}drop\ {\isacharparenleft}Suc\ {\isacharparenleft}length\ xs{\isacharparenright}{\isacharparenright}\ xsa{\isacharparenright}\ {\isacharequal}\ xsa{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ append{\isacharunderscore}eq{\isacharunderscore}append{\isacharunderscore}conv{\isacharunderscore}if\ id{\isacharunderscore}take{\isacharunderscore}nth{\isacharunderscore}drop\ linorder{\isacharunderscore}not{\isacharunderscore}less\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ nth{\isacharunderscore}append\ nth{\isacharunderscore}append{\isacharunderscore}length\ False\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}us\ {\isacharat}\ y\ {\isacharhash}\ zs\ {\isacharequal}\ zsa{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ True\ xsa{\isacharunderscore}zsa{\isadigit{1}}\ append{\isacharunderscore}eq{\isacharunderscore}append{\isacharunderscore}conv{\isacharunderscore}if\ append{\isacharunderscore}eq{\isacharunderscore}conv{\isacharunderscore}conj\ calculation{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ xa\ {\isacharequal}\ xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}\ {\isacharat}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\isacharparenleft}drop\ {\isacharparenleft}Suc\ {\isacharparenleft}length\ xs{\isacharparenright}{\isacharparenright}\ xsa{\isacharparenright}\ {\isacharat}\ ysa\ {\isacharat}\ us{\isacharparenright}\ {\isacharat}\ {\isacharbrackleft}y{\isacharbrackright}\ {\isacharat}\ zs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ e{\isacharunderscore}pair\ interp{\isacharunderscore}xa\ xa{\isacharunderscore}split{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}list{\isacharunderscore}order\ xa\ x\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ list{\isacharunderscore}order{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ {\isacharparenleft}xs\ {\isacharat}\ x\ {\isacharhash}\ ys{\isacharparenright}\ {\isacharless}\ length\ xsa{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ not{\isacharunderscore}less\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ {\isacharparenleft}xs\ {\isacharat}\ x\ {\isacharhash}\ ys\ {\isacharat}\ {\isacharbrackleft}y{\isacharbrackright}{\isacharparenright}\ {\isasymle}\ length\ xsa{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}xs\ {\isacharat}\ x\ {\isacharhash}\ ys\ {\isacharat}\ {\isacharbrackleft}y{\isacharbrackright}{\isacharparenright}\ {\isacharat}\ zs\ {\isacharequal}\ xsa\ {\isacharat}\ zsa{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ xsa{\isacharunderscore}zsa{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ vs\ \isakeyword{where}\ {\isachardoublequoteopen}{\isacharparenleft}xs\ {\isacharat}\ x\ {\isacharhash}\ ys\ {\isacharat}\ {\isacharbrackleft}y{\isacharbrackright}{\isacharparenright}\ {\isacharat}\ vs\ {\isacharequal}\ xsa{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ app{\isacharunderscore}length{\isacharunderscore}lt{\isacharunderscore}exists\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}xsa\ {\isacharat}\ ysa\ {\isacharat}\ zsa\ {\isacharequal}\ xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}\ {\isacharat}\ ys\ {\isacharat}\ {\isacharbrackleft}y{\isacharbrackright}\ {\isacharat}\ vs\ {\isacharat}\ ysa\ {\isacharat}\ zsa{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ xa\ {\isacharequal}\ xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}\ {\isacharat}\ ys\ {\isacharat}\ {\isacharbrackleft}y{\isacharbrackright}\ {\isacharat}\ {\isacharparenleft}vs\ {\isacharat}\ ysa\ {\isacharat}\ zsa{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ e{\isacharunderscore}pair\ interp{\isacharunderscore}xa\ xa{\isacharunderscore}split\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}list{\isacharunderscore}order\ xa\ x\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ list{\isacharunderscore}order{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isamarkupsubsection{Relationship to strong list specification%
}
\isamarkuptrue%
%
\begin{isamarkuptext}%
Attiya et al. \cite{Attiya:2016kh} give a specification of collaborative
text editing, called $\mathcal{A}_\textsf{strong}$. In this section we prove
that our specification is stronger than $\mathcal{A}_\textsf{strong}$, by
showing that whenever an OpSet is interpreted using our list function, the
outcome satisfies all of the criteria that make up Attiya et al.'s
specification.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ insert{\isacharunderscore}spec{\isacharunderscore}nth{\isacharunderscore}oid{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}distinct\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}n\ {\isacharless}\ length\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeyword{shows}\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ xs\ {\isacharparenleft}oid{\isacharcomma}\ Some\ {\isacharparenleft}xs\ {\isacharbang}\ n{\isacharparenright}{\isacharparenright}\ {\isacharbang}\ Suc\ n\ {\isacharequal}\ oid{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induction\ xs\ arbitrary{\isacharcolon}\ n{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ {\isacharparenleft}{\isacharbrackleft}{\isacharbrackright}\ {\isacharbang}\ n{\isacharparenright}{\isacharparenright}\ {\isacharbang}\ Suc\ n\ {\isacharequal}\ oid{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ xs{\isacharparenright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isachardot}prems{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ {\isacharparenleft}{\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharbang}\ n{\isacharparenright}{\isacharparenright}\ {\isacharbang}\ Suc\ n\ {\isacharequal}\ oid{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}a\ {\isacharequal}\ {\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharbang}\ n{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}n\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}distinct\ {\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}{\isacartoucheclose}\ Cons{\isachardot}prems{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ gr{\isacharunderscore}implies{\isacharunderscore}not{\isacharunderscore}zero\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ {\isacharparenleft}{\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharbang}\ n{\isacharparenright}{\isacharparenright}\ {\isacharbang}\ Suc\ n\ {\isacharequal}\ oid{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}n\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}distinct\ {\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}{\isacartoucheclose}\ Cons{\isachardot}prems{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ gr{\isacharunderscore}implies{\isacharunderscore}not{\isacharunderscore}zero\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ m\ \isakeyword{where}\ {\isachardoublequoteopen}n\ {\isacharequal}\ Suc\ m{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Suc{\isacharunderscore}pred{\isacharprime}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}insert{\isacharunderscore}spec\ {\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ {\isacharparenleft}{\isacharparenleft}a\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharbang}\ n{\isacharparenright}{\isacharparenright}\ {\isacharbang}\ Suc\ n\ {\isacharequal}\ oid{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons{\isachardot}IH\ Cons{\isachardot}prems\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ correct{\isacharunderscore}position{\isacharunderscore}insert{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ {\isacharparenleft}xs\ {\isacharat}\ {\isacharbrackleft}make{\isacharunderscore}insert\ ys\ oid\ m{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ xs\ {\isacharequal}\ ys{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ {\isacharparenleft}xs\ {\isacharat}\ {\isacharbrackleft}make{\isacharunderscore}insert\ ys\ oid\ m{\isacharbrackright}{\isacharparenright}\ {\isacharbang}\ min\ {\isacharparenleft}length\ ys{\isacharparenright}\ m\ {\isacharequal}\ oid{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}m\ {\isacharequal}\ {\isadigit{0}}\ {\isasymor}\ ys\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}make{\isacharunderscore}insert\ ys\ oid\ m\ {\isacharequal}\ {\isacharparenleft}oid{\isacharcomma}\ None{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}min\ {\isacharparenleft}length\ ys{\isacharparenright}\ m\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ m{\isacharcomma}\ auto{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ interp{\isacharunderscore}list{\isacharunderscore}tail{\isacharunderscore}unfold{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ this\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}m\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}ys\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ neq{\isadigit{0}}{\isacharunderscore}conv\ \isacommand{by}\isamarkupfalse%
\ blast{\isacharplus}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ this\ \isacommand{obtain}\isamarkupfalse%
\ nat\ \isakeyword{where}\ {\isachardoublequoteopen}m\ {\isacharequal}\ Suc\ nat{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ gr{\isadigit{0}}{\isacharunderscore}implies{\isacharunderscore}Suc\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}make{\isacharunderscore}insert\ ys\ oid\ m\ {\isacharequal}\ {\isacharparenleft}oid{\isacharcomma}\ Some\ {\isacharparenleft}ys\ {\isacharbang}\ min\ {\isacharparenleft}length\ ys\ {\isacharminus}\ {\isadigit{1}}{\isacharparenright}\ nat{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ False\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ ys{\isacharcomma}\ auto{\isacharparenright}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ {\isacharparenleft}xs\ {\isacharat}\ {\isacharbrackleft}make{\isacharunderscore}insert\ ys\ oid\ m{\isacharbrackright}{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ insert{\isacharunderscore}spec\ ys\ {\isacharparenleft}oid{\isacharcomma}\ Some\ {\isacharparenleft}ys\ {\isacharbang}\ min\ {\isacharparenleft}length\ ys\ {\isacharminus}\ {\isadigit{1}}{\isacharparenright}\ nat{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ interp{\isacharunderscore}list{\isacharunderscore}tail{\isacharunderscore}unfold{\isacharparenright}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}min\ {\isacharparenleft}length\ ys\ {\isacharminus}\ {\isadigit{1}}{\isacharparenright}\ nat\ {\isacharless}\ length\ ys{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}meson\ False\ diff{\isacharunderscore}less\ length{\isacharunderscore}greater{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}conv\ min{\isachardot}strict{\isacharunderscore}coboundedI{\isadigit{1}}\ zero{\isacharunderscore}less{\isacharunderscore}one{\isacharparenright}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ insert{\isacharunderscore}spec{\isacharunderscore}nth{\isacharunderscore}oid\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}no{\isacharunderscore}types{\isacharcomma}\ lifting{\isacharparenright}\ False\ Suc{\isacharunderscore}pred{\isacharprime}\ {\isacartoucheopen}m\ {\isacharequal}\ Suc\ nat{\isacartoucheclose}\ insert{\isacharunderscore}ops{\isacharunderscore}rem{\isacharunderscore}last\isanewline
\ \ \ \ \ \ \ \ interp{\isacharunderscore}list{\isacharunderscore}distinct\ length{\isacharunderscore}greater{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}conv\ min{\isacharunderscore}Suc{\isacharunderscore}Suc{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}order{\isacharunderscore}transp{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ op{\isacharunderscore}list{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}transp\ {\isacharparenleft}list{\isacharunderscore}order\ op{\isacharunderscore}list{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ list{\isacharunderscore}order{\isacharunderscore}trans\ transpI\ \isacommand{by}\isamarkupfalse%
\ metis%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}split{\isacharunderscore}two{\isacharunderscore}elems{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}distinct\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ xs{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}y\ {\isasymin}\ set\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}x\ {\isasymnoteq}\ y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymexists}pre\ mid\ suf{\isachardot}\ xs\ {\isacharequal}\ pre\ {\isacharat}\ x\ {\isacharhash}\ mid\ {\isacharat}\ y\ {\isacharhash}\ suf\ {\isasymor}\ xs\ {\isacharequal}\ pre\ {\isacharat}\ y\ {\isacharhash}\ mid\ {\isacharat}\ x\ {\isacharhash}\ suf{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ as\ bs\ \isakeyword{where}\ as{\isacharunderscore}bs{\isacharcolon}\ {\isachardoublequoteopen}xs\ {\isacharequal}\ as\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}\ {\isacharat}\ bs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ split{\isacharunderscore}list{\isacharunderscore}first\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}cases\ {\isachardoublequoteopen}y\ {\isasymin}\ set\ as{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ cs\ ds\ \isakeyword{where}\ {\isachardoublequoteopen}as\ {\isacharequal}\ cs\ {\isacharat}\ {\isacharbrackleft}y{\isacharbrackright}\ {\isacharat}\ ds{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ split{\isacharunderscore}list{\isacharunderscore}first\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ as{\isacharunderscore}bs{\isacharparenright}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isasymin}\ set\ bs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ as{\isacharunderscore}bs\ assms{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ assms{\isacharparenleft}{\isadigit{4}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ cs\ ds\ \isakeyword{where}\ {\isachardoublequoteopen}bs\ {\isacharequal}\ cs\ {\isacharat}\ {\isacharbrackleft}y{\isacharbrackright}\ {\isacharat}\ ds{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ split{\isacharunderscore}list{\isacharunderscore}first\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ as{\isacharunderscore}bs{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}order{\isacharunderscore}total{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ op{\isacharunderscore}list{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}interp{\isacharunderscore}list\ op{\isacharunderscore}list{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}y\ {\isasymin}\ set\ {\isacharparenleft}interp{\isacharunderscore}list\ op{\isacharunderscore}list{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}x\ {\isasymnoteq}\ y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}list{\isacharunderscore}order\ op{\isacharunderscore}list\ x\ y\ {\isasymor}\ list{\isacharunderscore}order\ op{\isacharunderscore}list\ y\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}interp{\isacharunderscore}list\ op{\isacharunderscore}list{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ interp{\isacharunderscore}list{\isacharunderscore}distinct{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ pre\ mid\ suf\isanewline
\ \ \ \ \isakeyword{where}\ {\isachardoublequoteopen}interp{\isacharunderscore}list\ op{\isacharunderscore}list\ {\isacharequal}\ pre\ {\isacharat}\ x\ {\isacharhash}\ mid\ {\isacharat}\ y\ {\isacharhash}\ suf\ {\isasymor}\isanewline
\ \ \ \ \ \ \ \ \ \ \ interp{\isacharunderscore}list\ op{\isacharunderscore}list\ {\isacharequal}\ pre\ {\isacharat}\ y\ {\isacharhash}\ mid\ {\isacharat}\ x\ {\isacharhash}\ suf{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ list{\isacharunderscore}split{\isacharunderscore}two{\isacharunderscore}elems\ assms\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}list{\isacharunderscore}order\ op{\isacharunderscore}list\ x\ y\ {\isasymor}\ list{\isacharunderscore}order\ op{\isacharunderscore}list\ y\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ list{\isacharunderscore}order{\isacharunderscore}def{\isacharcomma}\ blast{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}order{\isacharunderscore}irrefl{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}insert{\isacharunderscore}ops\ op{\isacharunderscore}list{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymnot}\ list{\isacharunderscore}order\ op{\isacharunderscore}list\ x\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ interp{\isacharunderscore}list{\isacharunderscore}distinct\ list{\isacharunderscore}orderE\ \isacommand{by}\isamarkupfalse%
\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "root"
%%% End:
